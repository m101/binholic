<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>December HZV Meet : Linux Kernel Exploitation</title>
  <meta name="description" content="Hello,">

  <link rel="stylesheet" href="/binholic/assets/css/main.css">
  <link rel="canonical" href="/binholic/2013/12/18/december-hzv-meet-linux-kernel.html">
  <link rel="alternate" type="application/rss+xml" title="Binary World for Binary People :)" href="/binholic/feed.xml">
</head>


  <body>

    <header class="site-header">

  <div class="wrapper">

    <a class="site-title" href="/binholic/">Binary World for Binary People :)</a>

    <!--
    <h2 class="site-subtitle">
        <span class="site-subtitle-quote">"empty
"</span>
        <span class="site-subtitle-author">- no_author -</span>
    </h2>
    -->

    <nav class="site-nav">
      <a href="#" class="menu-icon">
        <svg viewBox="0 0 18 15">
          <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </a>

      
      <div class="trigger">
        
          
          <a class="page-link" href="/binholic/about/">About</a>
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
        <a class="page-link" href="/binholic/blog/">Blog</a>
      </div>
      
    </nav>

  </div>

</header>


    <div class="page-content">
      <div class="wrapper">
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title" itemprop="name headline">December HZV Meet : Linux Kernel Exploitation</h1>
    <p class="post-meta"><time datetime="2013-12-18T19:09:00+01:00" itemprop="datePublished">Dec 18, 2013</time> • <span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">m_101</span></span></p>
  </header>

  <div class="post-content" itemprop="articleBody">
    <p>Hello,</p>

<p>So, last Saturday, I did a talk about Linux Kernel Exploitation.</p>

<p>I went over some well known vulnerabilities and I ended with a demo on a kernel exploitation challenge (<a href="http://git.zx2c4.com/kernel-pwn-challenge/">here</a>) by Jason Donenfeld (<a href="http://zx2c4.com/">his site</a>).
<strong>The slides are at the end of this blog article.</strong></p>

<p><strong>In this post, I will detail a bit more some of the slides in the talk.</strong></p>

<p><strong>I will not detail every single slides, only the ones where I think there isn’t enough details. If you don’t understand some things, don’t hesitate to comment ;).</strong></p>

<p>So, let’s dig in.</p>

<h1 id="linux-kernel">Linux Kernel</h1>

<p>The kernel has LOTS of code.</p>

<p>15+ millions lines of code.</p>

<p>LOTS of code mean complexity, complexity mean bugs and bugs mean potential vulnerabilities ;).</p>

<p>Anyhow, the main gateway for users to interact with the kernel are syscalls and IOCTLs.</p>

<p>Behind a syscall, especially network ones, there is a TONS of code.</p>

<p>Effectively, for a bind() call, you have the same interface right?</p>

<p>Well, the kernel, find the corresponding structure using the socket descriptor you use with your bind call.</p>

<p>In that structure, there is what is called a struct proto_ops which contains callbacks for the corresponding protocol.</p>

<h1 id="exploiting-the-linux-kernel">Exploiting the Linux Kernel</h1>

<p>The Linux Kernel is made of code, it is software.
And everyone do know that software has bugs and vulnerabilities.
The Linux Kernel is not an exception.</p>

<p>You will mostly find all the vulnerabilities you know from userland:</p>

<ul>
  <li>stack based buffer overflows</li>
  <li>heap based buffer overflows</li>
  <li>race conditions</li>
  <li>integer signedness issues</li>
  <li>information leaks</li>
  <li>initialisation issues</li>
  <li>etc</li>
</ul>

<p>And some different ones:</p>

<ul>
  <li>NULL Pointer Dereference</li>
  <li>stack overflow (real ones, not based on)</li>
  <li>process manipulation tricks (mempodipper)</li>
  <li>etc</li>
</ul>

<p><strong>__copy_to_user()</strong> and <strong>copy_to_user()</strong> are not the same.</p>

<p>The first one doesn’t check that the address effectively live in userland while the second one do that.</p>

<p>The goal of exploiting the kernel is mainly to get root.</p>

<h1 id="null-pointer-dereference">NULL Pointer Dereference</h1>

<p>It was (is?) exploitable in kernel simply because you could (can?) map the NULL page in your exploit as it lives in userland. As such, it doesn’t crash.</p>

<h1 id="heuristics">Heuristics</h1>

<p>These are routines that allow you to have good enough approximations.</p>

<p>For instance, before 2.6.29, credentials were stored like this in the kernel:</p>

<figure class="highlight"><pre><code class="language-c" data-lang="c"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre></td><td class="code"><pre><span class="cm">/*
Kernel 2.6.23
include/linux/sched.h
*/</span>

<span class="k">struct</span> <span class="n">task_struct</span> <span class="p">{</span>
<span class="cm">/* ... */</span>

<span class="cm">/* process credentials */</span>
    <span class="n">uid_t</span> <span class="n">uid</span><span class="p">,</span><span class="n">euid</span><span class="p">,</span><span class="n">suid</span><span class="p">,</span><span class="n">fsuid</span><span class="p">;</span>
    <span class="n">gid_t</span> <span class="n">gid</span><span class="p">,</span><span class="n">egid</span><span class="p">,</span><span class="n">sgid</span><span class="p">,</span><span class="n">fsgid</span><span class="p">;</span>
    <span class="k">struct</span> <span class="n">group_info</span> <span class="o">*</span><span class="n">group_info</span><span class="p">;</span>
    <span class="n">kernel_cap_t</span>   <span class="n">cap_effective</span><span class="p">,</span> <span class="n">cap_inheritable</span><span class="p">,</span> <span class="n">cap_permitted</span><span class="p">;</span>
    <span class="kt">unsigned</span> <span class="n">keep_capabilities</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
    <span class="k">struct</span> <span class="n">user_struct</span> <span class="o">*</span><span class="n">user</span><span class="p">;</span>

<span class="cm">/* ... */</span>
<span class="p">};</span></pre></td></tr></tbody></table></code></pre></figure>

<p>As you can see, uid, euid and suid will generally have the same value.
So if you set thos values to 0, your process basically has root privileges.
This heuristic is good enough as there is little chance that you will have 3 dwords with the same values in memory (don’t forget we start to search from our current task_struct that represent our exploit process).</p>

<p>This routine before 2.6.29 was thus enough to get root:</p>

<figure class="highlight"><pre><code class="language-c" data-lang="c"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre></td><td class="code"><pre><span class="c1">// get root before 2.6.29 kernel</span>
<span class="kt">void</span> <span class="nf">get_root_pre_2_6_29</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">uid_t</span> <span class="n">uid</span><span class="p">,</span> <span class="o">*</span><span class="n">cred</span><span class="p">;</span>
    <span class="kt">size_t</span> <span class="n">byte</span><span class="p">;</span>

    <span class="n">uid</span> <span class="o">=</span> <span class="n">getuid</span><span class="p">();</span>
    <span class="n">cred</span> <span class="o">=</span> <span class="n">get_task_struct</span><span class="p">();</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">cred</span><span class="p">)</span>
        <span class="k">return</span><span class="p">;</span>

    <span class="k">for</span> <span class="p">(</span><span class="n">byte</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">byte</span> <span class="o">&lt;</span> <span class="n">PAGE_SIZE</span><span class="p">;</span> <span class="n">byte</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">cred</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">uid</span>
                <span class="o">&amp;&amp;</span> <span class="n">cred</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">uid</span>
                <span class="o">&amp;&amp;</span> <span class="n">cred</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="n">uid</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">cred</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">cred</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">cred</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">cred</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
            <span class="n">cred</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="n">cred</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="n">cred</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="n">cred</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="n">cred</span><span class="o">++</span><span class="p">;</span>        
    <span class="p">}</span>
<span class="p">}</span></pre></td></tr></tbody></table></code></pre></figure>

<h1 id="root-in-3-big-steps">Root in 3 big steps</h1>

<p>You’ve basically got 3 big steps: prepare, trigger vulnerability, trigger payload.</p>

<h2 id="prepare">Prepare</h2>

<p>This is the most important step as this will greatly affect the reliability of your exploit.</p>

<p>This is where you:</p>

<ul>
  <li>check that the kernel is vulnerable.</li>
  <li>use information leaks</li>
  <li>prepare the memory layout so you can predict reliably where your objects are</li>
  <li>place your shell code in memory</li>
</ul>

<p>The avantage of shellcoding in the kernel : it is in C.</p>

<h2 id="trigger-vulnerability">Trigger vulnerability</h2>

<p>This is where you will exploit your vulnerability.</p>

<p>Patching memory, pointers and whatsoever.</p>

<h2 id="trigger-payload">Trigger payload</h2>

<p>This is where you escalate the privileges of your process.</p>

<p>This is also where you fix the mayhem you may have caused earlier.
It is REALLY important to fix the things you messed up as otherwise the machine may crash later.
It is done in the payload as the payload is executed in kernel mode. root is in userland, root != kernel land, don’t get confused about that.</p>

<p>After triggering the payload, you go back in userland and spawn your root shell or whatsoever.</p>

<p>Ok, now that you have the basic understanding, you are ready for some kernel goodies.</p>

<h1 id="linux-kernel-exploitation">Linux Kernel Exploitation</h1>

<p>I won’t explain CVE-2009-2692 unless some people ask for it.
It is simple enough using the slides to comprehend.</p>

<p>Anyhow, let’s dig in TUN NULL Pointer Dereference.</p>

<h2 id="tun-null-pointer-dereference">TUN NULL Pointer Dereference</h2>

<p>This vulnerability is really interesting as there is something really special about it : the vulnerability is NOT in the source code. It is inserted at compilation.
Basically, what happens is that tun is dereferenced before checking that tun is NULL. As such, GCC considers that the pointer doesn’t need checking as we use it before checking : GCC removes the NULL check. Boom, vulnerability.</p>

<p>The vulnerable code:</p>

<figure class="highlight"><pre><code class="language-c" data-lang="c"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre></td><td class="code"><pre><span class="k">static</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="nf">tun_chr_poll</span><span class="p">(</span><span class="k">struct</span> <span class="n">file</span> <span class="o">*</span><span class="n">file</span><span class="p">,</span> <span class="n">poll_table</span> <span class="o">*</span> <span class="n">wait</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">struct</span> <span class="n">tun_file</span> <span class="o">*</span><span class="n">tfile</span> <span class="o">=</span> <span class="n">file</span><span class="o">-&gt;</span><span class="n">private_data</span><span class="p">;</span>
    <span class="k">struct</span> <span class="n">tun_struct</span> <span class="o">*</span><span class="n">tun</span> <span class="o">=</span> <span class="n">__tun_get</span><span class="p">(</span><span class="n">tfile</span><span class="p">);</span>
    <span class="k">struct</span> <span class="n">sock</span> <span class="o">*</span><span class="n">sk</span> <span class="o">=</span> <span class="n">tun</span><span class="o">-&gt;</span><span class="n">sk</span><span class="p">;</span>
    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">mask</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">tun</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">POLLERR</span><span class="p">;</span>

    <span class="cm">/* ... */</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">sock_writeable</span><span class="p">(</span><span class="n">sk</span><span class="p">)</span> <span class="o">||</span>
        <span class="p">(</span><span class="o">!</span><span class="n">test_and_set_bit</span><span class="p">(</span><span class="n">SOCK_ASYNC_NOSPACE</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">sk</span><span class="o">-&gt;</span><span class="n">sk_socket</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
         <span class="n">sock_writeable</span><span class="p">(</span><span class="n">sk</span><span class="p">)))</span>
        <span class="n">mask</span> <span class="o">|=</span> <span class="n">POLLOUT</span> <span class="o">|</span> <span class="n">POLLWRNORM</span><span class="p">;</span>

    <span class="cm">/* ... */</span>

    <span class="k">return</span> <span class="n">mask</span><span class="p">;</span>
<span class="p">}</span></pre></td></tr></tbody></table></code></pre></figure>

<p>So the NULL check doesn’t exist and tun is NULL.
So we can map the NULL page and we thus control tun-&gt;sk.
We control sk-&gt;sk_socket-&gt;flags as well.
test_and_set_bit() set the last bit at 1.
Bang, we can set any NULL pointer to 1.
In the exploit, mmap() is chosen as the TUN device doesn’t have a mmap().
mmap() need to be see to one even though we control the NULL page as internally mmap() is not called if it’s NULL.
Put a trampoline at address 1 to jump over all the junk you’ve set up and go to your payload.
And that it’s, you’ve escalated your privileges.</p>

<h3 id="why-mmap-cant-be-null">Why mmap() can’t be NULL?</h3>

<p>If you dig around in the kernel, here is what to look for:</p>

<figure class="highlight"><pre><code class="language-c" data-lang="c"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
</pre></td><td class="code"><pre><span class="c1">// arch/x86/kernel/sys_x86_64.c:21: asmlinkage long sys_mmap(unsigned long addr, unsigned long len,</span>
<span class="n">asmlinkage</span> <span class="kt">long</span> <span class="nf">sys_mmap</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">addr</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">len</span><span class="p">,</span>
        <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">prot</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">flags</span><span class="p">,</span>
        <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">fd</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">off</span><span class="p">)</span>
<span class="p">{</span>
    <span class="kt">long</span> <span class="n">error</span><span class="p">;</span>
    <span class="k">struct</span> <span class="n">file</span> <span class="o">*</span><span class="n">file</span><span class="p">;</span>

    <span class="n">error</span> <span class="o">=</span> <span class="o">-</span><span class="n">EINVAL</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">off</span> <span class="o">&amp;</span> <span class="o">~</span><span class="n">PAGE_MASK</span><span class="p">)</span>
        <span class="k">goto</span> <span class="n">out</span><span class="p">;</span>

    <span class="n">error</span> <span class="o">=</span> <span class="o">-</span><span class="n">EBADF</span><span class="p">;</span>
    <span class="n">file</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
    <span class="n">flags</span> <span class="o">&amp;=</span> <span class="o">~</span><span class="p">(</span><span class="n">MAP_EXECUTABLE</span> <span class="o">|</span> <span class="n">MAP_DENYWRITE</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="n">flags</span> <span class="o">&amp;</span> <span class="n">MAP_ANONYMOUS</span><span class="p">))</span> <span class="p">{</span>
        <span class="n">file</span> <span class="o">=</span> <span class="n">fget</span><span class="p">(</span><span class="n">fd</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">file</span><span class="p">)</span>
            <span class="k">goto</span> <span class="n">out</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">down_write</span><span class="p">(</span><span class="o">&amp;</span><span class="n">current</span><span class="o">-&gt;</span><span class="n">mm</span><span class="o">-&gt;</span><span class="n">mmap_sem</span><span class="p">);</span>
    <span class="n">error</span> <span class="o">=</span> <span class="n">do_mmap_pgoff</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">addr</span><span class="p">,</span> <span class="n">len</span><span class="p">,</span> <span class="n">prot</span><span class="p">,</span> <span class="n">flags</span><span class="p">,</span> <span class="n">off</span> <span class="o">&gt;&gt;</span> <span class="n">PAGE_SHIFT</span><span class="p">);</span>
    <span class="n">up_write</span><span class="p">(</span><span class="o">&amp;</span><span class="n">current</span><span class="o">-&gt;</span><span class="n">mm</span><span class="o">-&gt;</span><span class="n">mmap_sem</span><span class="p">);</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">file</span><span class="p">)</span>
        <span class="n">fput</span><span class="p">(</span><span class="n">file</span><span class="p">);</span>
<span class="nl">out:</span>
    <span class="k">return</span> <span class="n">error</span><span class="p">;</span>
<span class="p">}</span></pre></td></tr></tbody></table></code></pre></figure>

<p>If you go down do_mmap_pgoff(), you end up finding this code:</p>

<figure class="highlight"><pre><code class="language-c" data-lang="c"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="code"><pre><span class="c1">// mm/mmap.c</span>

<span class="cm">/* ... */</span> 

            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">file</span><span class="o">-&gt;</span><span class="n">f_op</span> <span class="o">||</span> <span class="o">!</span><span class="n">file</span><span class="o">-&gt;</span><span class="n">f_op</span><span class="o">-&gt;</span><span class="n">mmap</span><span class="p">)</span>
                <span class="k">return</span> <span class="o">-</span><span class="n">ENODEV</span><span class="p">;</span>
            <span class="k">break</span><span class="p">;</span>

<span class="cm">/* ... */</span></pre></td></tr></tbody></table></code></pre></figure>

<p>So here it is, if mmap() is NULL, it doesn’t get called.
That is why it sets the mmap() pointer to 1.</p>

<h1 id="other-exploits">Other exploits</h1>

<p>This is where it gets pretty hard to explain as there is still tons of code to read x).
I dug a bit in vmsplice, RDS and perf_events exploits.</p>

<p>vmsplice use buffer overflow, but it’s not a common one as it doesn’t overwrite any function or return pointers. What it overwrites are compound page addresses (values we don’t control) and then call a dtor pointer the attacker control.
Privileged code execution is gained in put_compound_page() through the call of a destructor function pointer that we control.
This dtor pointer obviously points to the attacker payload. 
At the end of the article, I’ve attached some analysis I did for vmsplice. There is lot of code to cover though so I won’t detail it in this post.</p>

<p>I haven’t thoroughly analyzed the RDS exploit yet but it is a write-what-where.</p>

<p>The perf_events exploit is really interesting.
It ‘basically’ increment a INT handler pointer upper bytes in 64 bits so the pointer end up in userland. The exploit then return to this allocated memory containing the payload.
The exploit also use a neat trick to compute the perf_event array. An entire post is necessary as well to properly understand this exploit. Analysis have already been done anyhow by other people.</p>

<h1 id="the-challenge">The challenge</h1>

<p>The VM is a 64 Bit Linux system made especially by Jason Donenfeld (aka <a href="http://zx2c4.com/">zx2c4</a>).
The vulnerability allows us to write a 0 anywhere in kernel memory.
As such, in my exploit, I zeroed out some part of a proto_ops function pointer. mmap() it, put my payload over there, jump to it and fix it.</p>

<p>I debugged the exploit using registry information showed when the exploit crashed.</p>

<p>The exploit is included in the archive below.</p>

<h1 id="conclusion">Conclusion</h1>

<p>As you can see, kernel exploitation has some similitudes with userland exploitation.
The differences mainly stem in the protections and the impact that a bug can have.
For instance, in kernel-land, not initializing a structure fully can have severe consequence (code execution through NULL pointer dereference, etc) while in userland, it may cause an infoleak but not directly code execution.</p>

<p>Moreover, this also shows that the kernel is piece of software and is as such exploitable.</p>

<p>Hope you enjoyed the article,</p>

<p>I welcome any feedback on it,</p>

<p>Cheers,</p>

<p>m_101</p>

<h1 id="resources">Resources</h1>

<ul>
  <li>The slides : <a href="http://www.mediafire.com/download/egnjx6jxjdbr3mu/hzvmeet-talk-20131207-m101-linux-kernel-exploitation.zip">here</a></li>
  <li>Jason Donenfield’s challenge : <a href="http://git.zx2c4.com/kernel-pwn-challenge/">here</a></li>
  <li>sgrakkyu’s blog : <a href="http://kernelbof.blogspot.fr/">here</a></li>
  <li><a href="http://www.phrack.org/archives/64/p64_0x06_Attacking%20the%20Core:%20Kernel%20Exploitation%20Notes_by_twiz%20&amp;%20sgrakkyu.txt">Attacking the Core : Kernel Exploiting Note</a></li>
  <li><span class="lrg bold">“A Guide to Kernel Exploitation: Attacking the Core</span>” <span class="med reg">de Enrico Perla et Massimiliano Oldani</span></li>
  <li>Miscellaneous exploits : <a href="http://www.exploit-db.com/exploits/9641/">NULL deref sendpage</a>, <a href="http://www.exploit-db.com/exploits/9191/">NULL deref /dev/net/tun</a>, <a href="http://www.exploit-db.com/exploits/5092/">vmsplice</a>, <a href="http://www.exploit-db.com/exploits/15285/">RDS write-what-where</a>, <a href="http://www.exploit-db.com/exploits/26131/">integer problem perf_swevent</a></li>
  <li>MISC explaining perf_swevent exploit : <a href="http://boutique.ed-diamond.com/misc/495-misc69.html">Misc 69</a></li>
</ul>


  </div>

  <div class="post-navigation">
    
    <a class="post-prev" href="/binholic/2013/12/13/lfi-exploitation-basics-code-execution.html">Previous : LFI Exploitation : Basics, code execution and information leak</a>
    

    
    <a class="post-next" href="/binholic/2013/12/27/ivans-amenra-level-1.html">Next : [Wargame] Ivan's Amenra : level 1</a>
    
  </div>

  
    <div id="disqus_thread"></div>
    <script>
        var disqus_config = function () {
            this.page.url = "http://binholic.com/2013/12/18/december-hzv-meet-linux-kernel.html";
            this.page.identifier = "/2013/12/18/december-hzv-meet-linux-kernel";
        };

        (function() { // DON'T EDIT BELOW THIS LINE
            var d = document, s = d.createElement('script');

            s.src = '//binholic.disqus.com/embed.js';

            s.setAttribute('data-timestamp', +new Date());
            (d.head || d.body).appendChild(s);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
  

</article>

      </div>
    </div>

    <footer class="site-footer">

  <div class="wrapper">

      <div class="site-footer">
        <ul class="social-media-list">
          
          <li>
            <a href="https://github.com/m101"><span class="icon icon--github"><svg viewBox="0 0 16 16"><path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/></svg>
</span></a>

          </li>
          

          
          <li>
            <a href="https://twitter.com/w_levin"><span class="icon icon--twitter"><svg viewBox="0 0 16 16"><path fill="#828282" d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27 c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767 c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206 C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271 c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469 c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"/></svg>
</span></a>

          </li>
          

          
          <li>
            <a href="mailto:m101.sec@gmail.com"><span class="icon icon--email"><?xml version="1.0" encoding="UTF-8"?>
<!-- Generator: Adobe Illustrator 16.0.0, SVG Export Plug-In . SVG Version: 6.00 Build 0)  -->
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="240.665px" height="250px" viewBox="43.833 205.167 240.665 250" enable-background="new 43.833 205.167 240.665 250" xml:space="preserve">
<g>
	<path fill="#323232" d="M221.459,396.62c-8.84,0-15.904-2.21-21.191-6.63c-5.289-4.42-8.449-10.441-9.488-18.07   c-4.855,5.895-10.66,10.965-17.42,15.21c-6.762,4.249-14.561,6.37-23.4,6.37c-6.59,0-12.83-1.256-18.72-3.77   c-5.895-2.512-11.095-6.15-15.6-10.92c-4.509-4.766-8.105-10.571-10.79-17.42c-2.689-6.846-4.03-14.69-4.03-23.531   c0-9.879,1.56-19.064,4.68-27.56c3.12-8.49,7.365-15.86,12.74-22.1c5.371-6.24,11.7-11.136,18.98-14.69   c7.28-3.551,15.08-5.33,23.4-5.33c9.01,0,16.68,1.82,23.01,5.461c6.324,3.639,11.311,8.234,14.949,13.779l2.34-17.42h20.541   l-10.66,85.02c-0.52,3.99-0.781,7.021-0.781,9.101c0,5.029,1.041,8.929,3.121,11.7c2.08,2.774,5.545,4.16,10.4,4.16   c4.504,0,8.84-1.646,13-4.94c4.16-3.29,7.799-7.931,10.92-13.91c3.119-5.979,5.589-13.085,7.41-21.319   c1.82-8.23,2.729-17.291,2.729-27.17c0-11.961-2.123-23.051-6.369-33.281c-4.25-10.225-10.228-19.064-17.939-26.52   c-7.715-7.451-16.859-13.26-27.43-17.42c-10.576-4.16-22.189-6.24-34.842-6.24c-16.119,0-30.464,3.165-43.029,9.49   c-12.57,6.33-23.14,14.605-31.72,24.83c-8.58,10.229-15.08,21.799-19.5,34.71c-4.42,12.915-6.63,26.045-6.63,39.39   c0,15.08,2.34,28.516,7.02,40.301c4.68,11.789,11.18,21.795,19.5,30.029c8.32,8.23,18.11,14.471,29.38,18.721   c11.265,4.244,23.485,6.369,36.661,6.369c13.17,0,24.914-1.561,35.229-4.68c10.311-3.121,20.15-6.936,29.512-11.439l7.539,19.76   c-9.016,4.85-19.891,8.924-32.631,12.219c-12.738,3.291-26.479,4.941-41.209,4.941c-16.64,0-31.98-2.516-46.02-7.541   c-14.04-5.029-26.175-12.439-36.4-22.23c-10.229-9.795-18.2-21.84-23.92-36.139c-5.72-14.301-8.58-30.811-8.58-49.53   c0-17.331,2.99-33.841,8.97-49.53c5.98-15.686,14.471-29.51,25.48-41.47c11.005-11.96,24.266-21.45,39.78-28.47   c15.51-7.02,32.889-10.53,52.129-10.53c16.291,0,31.156,2.645,44.59,7.93c13.432,5.29,24.916,12.524,34.451,21.71   c9.529,9.189,16.898,20.064,22.1,32.63c5.199,12.568,7.799,26.129,7.799,40.689c0,12.48-1.518,23.965-4.549,34.45   c-3.035,10.489-7.195,19.5-12.48,27.04c-5.289,7.54-11.615,13.391-18.98,17.55C238.139,394.54,230.124,396.62,221.459,396.62z    M156.979,374.26c6.76,0,13-1.86,18.721-5.59c5.719-3.725,10.311-7.756,13.779-12.09l6.24-51.48   c-3.469-5.545-7.975-10.051-13.52-13.52c-5.551-3.465-11.875-5.2-18.98-5.2c-5.201,0-10.23,1.17-15.08,3.511   c-4.855,2.34-9.145,5.635-12.87,9.879c-3.729,4.25-6.675,9.32-8.84,15.211c-2.169,5.895-3.25,12.395-3.25,19.5   c0,13.174,3.291,23.1,9.88,29.77C139.645,370.925,147.62,374.26,156.979,374.26z"/>
</g>
</svg></span></a>

          </li>
          

          
          <li>
            <a href="http://127.0.0.1:8888/USK@ABR8mm2t1L1G8cBG70cDy4PHFO6LPV~LrA-RIZxgOGI,pnGWUxb7k8~5-ywwqnBakTXx5ZFw6QzzZj7H~45NgE8,AQACAAE/binholic/-1/"><span class="icon icon--freenet"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!-- Created with Inkscape (http://www.inkscape.org/) -->
<svg
   xmlns:svg="http://www.w3.org/2000/svg"
   xmlns="http://www.w3.org/2000/svg"
   version="1.0"
   width="79.12"
   height="52.64">
  <defs/>
  <g
     transform="translate(-47.495719,-111.30691)">
    <path
       d="M 80.03,122.66 C 94.49,107.06 104.32,113.99 87.53,124.89 C 82.19,128.36 83.58,129.37 87.17,128.82 C 92.24,128.05 95.01,129.02 96.24,129.98 C 99.18,132.28 100.65,130.57 101.64,128.82 C 103.61,125.35 110.25,129.12 105.39,132.75 C 101.59,135.58 102.12,138.77 105.57,140.61 C 111.96,144.01 126.30,150.75 124.14,157.93 C 123.26,160.86 121.67,163.62 118.07,159.89 C 111.32,152.92 106.83,146.97 91.28,144.54 C 81.24,142.96 71.15,140.33 61.46,145.25 C 56.90,147.67 51.16,149.23 49.94,146.37 C 48.35,142.64 56.47,139.57 64.32,138.82 C 69.42,138.33 73.99,134.99 67.00,133.29 C 58.39,130.64 68.28,123.09 74.50,124.89 C 78.55,126.07 78.95,123.83 80.03,122.66 z"
       style="fill:#ffffff;stroke:#356ace;stroke-width:1.5;" />
  </g>
</svg>
</span></a>

          </li>
          
        </ul>
      </div>

    </div>

  </div>

</footer>


  </body>

</html>
