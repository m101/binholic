<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>GCHQ Challenge Part 2 - http://www.canyoucrackit.co.uk/</title>
  <meta name="description" content="As I have seen that many people already posted their solutions … I do not see the point of keeping mine :). Here it is.">

  <link rel="stylesheet" href="/binholic/assets/css/main.css">
  <link rel="canonical" href="/binholic/2011/12/03/gchq-challenge-part-2.html">
  <link rel="alternate" type="application/rss+xml" title="Binary World for Binary People :)" href="/binholic/feed.xml">
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-16686496-2"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-16686496-2');
  </script>
  
</head>


  <body>

    <header class="site-header">

  <div class="wrapper">

    <a class="site-title" href="/binholic/">Binary World for Binary People :)</a>

    <!--
    <h2 class="site-subtitle">
        <span class="site-subtitle-quote">"empty
"</span>
        <span class="site-subtitle-author">- no_author -</span>
    </h2>
    -->

    <nav class="site-nav">
      <a href="#" class="menu-icon">
        <svg viewBox="0 0 18 15">
          <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </a>

      
      <div class="trigger">
        
          
          <a class="page-link" href="/binholic/about/">About</a>
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
        <a class="page-link" href="/binholic/blog/">Blog</a>
      </div>
      
    </nav>

  </div>

</header>


    <div class="page-content">
      <div class="wrapper">
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title" itemprop="name headline">GCHQ Challenge Part 2 - http://www.canyoucrackit.co.uk/</h1>
    <p class="post-meta"><time datetime="2011-12-03T18:40:00+01:00" itemprop="datePublished">Dec 3, 2011</time> • <span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">m_101</span></span></p>
  </header>

  <div class="post-content" itemprop="articleBody">
    <p><b style="color: red;">As I have seen that many people already posted their solutions … I do not see the point of keeping mine :). Here it is.</b></p>

<p>Hello again :),</p>

<p>Ok folks, you managed to get to level 2.</p>

<p>Let’s begin,</p>

<h1 id="the-challenge">The challenge</h1>

<p>We are presented with a JavaScript file:</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
</pre></td><td class="code"><pre><span class="c1">//--------------------------------------------------------------------------------------------------</span>
<span class="c1">//</span>
<span class="c1">// stage 2 of 3</span>
<span class="c1">//</span>
<span class="c1">// challenge:</span>
<span class="c1">//   reveal the solution within VM.mem</span>
<span class="c1">//</span>
<span class="c1">// disclaimer:</span>
<span class="c1">//   tested in ie 9, firefox 6, chrome 14 and v8 shell (http://code.google.com/apis/v8/build.html),</span>
<span class="c1">//   other javascript implementations may or may not work.</span>
<span class="c1">//</span>
<span class="c1">//--------------------------------------------------------------------------------------------------</span>

<span class="kd">var</span> <span class="nx">VM</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">cpu</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">ip</span><span class="p">:</span> <span class="mh">0x00</span><span class="p">,</span>
    <span class="na">r0</span><span class="p">:</span> <span class="mh">0x00</span><span class="p">,</span>
    <span class="na">r1</span><span class="p">:</span> <span class="mh">0x00</span><span class="p">,</span>
    <span class="na">r2</span><span class="p">:</span> <span class="mh">0x00</span><span class="p">,</span>
    <span class="na">r3</span><span class="p">:</span> <span class="mh">0x00</span><span class="p">,</span>
    <span class="na">cs</span><span class="p">:</span> <span class="mh">0x00</span><span class="p">,</span>
    <span class="na">ds</span><span class="p">:</span> <span class="mh">0x10</span><span class="p">,</span>
    <span class="na">fl</span><span class="p">:</span> <span class="mh">0x00</span><span class="p">,</span>
    <span class="na">firmware</span><span class="p">:</span> <span class="p">[</span><span class="mh">0xd2ab1f05</span><span class="p">,</span> <span class="mh">0xda13f110</span><span class="p">]</span>
  <span class="p">},</span>

  <span class="na">mem</span><span class="p">:</span> <span class="p">[</span>
    <span class="mh">0x31</span><span class="p">,</span> <span class="mh">0x04</span><span class="p">,</span> <span class="mh">0x33</span><span class="p">,</span> <span class="mh">0xaa</span><span class="p">,</span> <span class="mh">0x40</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="mh">0x80</span><span class="p">,</span> <span class="mh">0x03</span><span class="p">,</span> <span class="mh">0x52</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x72</span><span class="p">,</span> <span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x73</span><span class="p">,</span> <span class="mh">0x01</span><span class="p">,</span> <span class="mh">0xb2</span><span class="p">,</span> <span class="mh">0x50</span><span class="p">,</span>
    <span class="mh">0x30</span><span class="p">,</span> <span class="mh">0x14</span><span class="p">,</span> <span class="mh">0xc0</span><span class="p">,</span> <span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x80</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x10</span><span class="p">,</span> <span class="mh">0x10</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span>
    <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span>
    <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span>
    <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span>
    <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span>
    <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span>
    <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span>
    <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span>
    <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span>
    <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span>
    <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span>
    <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span>
    <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span>
    <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span>
    <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span>
    <span class="mh">0x98</span><span class="p">,</span> <span class="mh">0xab</span><span class="p">,</span> <span class="mh">0xd9</span><span class="p">,</span> <span class="mh">0xa1</span><span class="p">,</span> <span class="mh">0x9f</span><span class="p">,</span> <span class="mh">0xa7</span><span class="p">,</span> <span class="mh">0x83</span><span class="p">,</span> <span class="mh">0x83</span><span class="p">,</span> <span class="mh">0xf2</span><span class="p">,</span> <span class="mh">0xb1</span><span class="p">,</span> <span class="mh">0x34</span><span class="p">,</span> <span class="mh">0xb6</span><span class="p">,</span> <span class="mh">0xe4</span><span class="p">,</span> <span class="mh">0xb7</span><span class="p">,</span> <span class="mh">0xca</span><span class="p">,</span> <span class="mh">0xb8</span><span class="p">,</span>
    <span class="mh">0xc9</span><span class="p">,</span> <span class="mh">0xb8</span><span class="p">,</span> <span class="mh">0x0e</span><span class="p">,</span> <span class="mh">0xbd</span><span class="p">,</span> <span class="mh">0x7d</span><span class="p">,</span> <span class="mh">0x0f</span><span class="p">,</span> <span class="mh">0xc0</span><span class="p">,</span> <span class="mh">0xf1</span><span class="p">,</span> <span class="mh">0xd9</span><span class="p">,</span> <span class="mh">0x03</span><span class="p">,</span> <span class="mh">0xc5</span><span class="p">,</span> <span class="mh">0x3a</span><span class="p">,</span> <span class="mh">0xc6</span><span class="p">,</span> <span class="mh">0xc7</span><span class="p">,</span> <span class="mh">0xc8</span><span class="p">,</span> <span class="mh">0xc9</span><span class="p">,</span>
    <span class="mh">0xca</span><span class="p">,</span> <span class="mh">0xcb</span><span class="p">,</span> <span class="mh">0xcc</span><span class="p">,</span> <span class="mh">0xcd</span><span class="p">,</span> <span class="mh">0xce</span><span class="p">,</span> <span class="mh">0xcf</span><span class="p">,</span> <span class="mh">0xd0</span><span class="p">,</span> <span class="mh">0xd1</span><span class="p">,</span> <span class="mh">0xd2</span><span class="p">,</span> <span class="mh">0xd3</span><span class="p">,</span> <span class="mh">0xd4</span><span class="p">,</span> <span class="mh">0xd5</span><span class="p">,</span> <span class="mh">0xd6</span><span class="p">,</span> <span class="mh">0xd7</span><span class="p">,</span> <span class="mh">0xd8</span><span class="p">,</span> <span class="mh">0xd9</span><span class="p">,</span>
    <span class="mh">0xda</span><span class="p">,</span> <span class="mh">0xdb</span><span class="p">,</span> <span class="mh">0xa9</span><span class="p">,</span> <span class="mh">0xcd</span><span class="p">,</span> <span class="mh">0xdf</span><span class="p">,</span> <span class="mh">0xdf</span><span class="p">,</span> <span class="mh">0xe0</span><span class="p">,</span> <span class="mh">0xe1</span><span class="p">,</span> <span class="mh">0xe2</span><span class="p">,</span> <span class="mh">0xe3</span><span class="p">,</span> <span class="mh">0xe4</span><span class="p">,</span> <span class="mh">0xe5</span><span class="p">,</span> <span class="mh">0xe6</span><span class="p">,</span> <span class="mh">0xe7</span><span class="p">,</span> <span class="mh">0xe8</span><span class="p">,</span> <span class="mh">0xe9</span><span class="p">,</span>
    <span class="mh">0x26</span><span class="p">,</span> <span class="mh">0xeb</span><span class="p">,</span> <span class="mh">0xec</span><span class="p">,</span> <span class="mh">0xed</span><span class="p">,</span> <span class="mh">0xee</span><span class="p">,</span> <span class="mh">0xef</span><span class="p">,</span> <span class="mh">0xf0</span><span class="p">,</span> <span class="mh">0xf1</span><span class="p">,</span> <span class="mh">0xf2</span><span class="p">,</span> <span class="mh">0xf3</span><span class="p">,</span> <span class="mh">0xf4</span><span class="p">,</span> <span class="mh">0xf5</span><span class="p">,</span> <span class="mh">0xf6</span><span class="p">,</span> <span class="mh">0xf7</span><span class="p">,</span> <span class="mh">0xf8</span><span class="p">,</span> <span class="mh">0xf9</span><span class="p">,</span>
    <span class="mh">0x7d</span><span class="p">,</span> <span class="mh">0x1f</span><span class="p">,</span> <span class="mh">0x15</span><span class="p">,</span> <span class="mh">0x60</span><span class="p">,</span> <span class="mh">0x4d</span><span class="p">,</span> <span class="mh">0x4d</span><span class="p">,</span> <span class="mh">0x52</span><span class="p">,</span> <span class="mh">0x7d</span><span class="p">,</span> <span class="mh">0x0e</span><span class="p">,</span> <span class="mh">0x27</span><span class="p">,</span> <span class="mh">0x6d</span><span class="p">,</span> <span class="mh">0x10</span><span class="p">,</span> <span class="mh">0x6d</span><span class="p">,</span> <span class="mh">0x5a</span><span class="p">,</span> <span class="mh">0x06</span><span class="p">,</span> <span class="mh">0x56</span><span class="p">,</span>
    <span class="mh">0x47</span><span class="p">,</span> <span class="mh">0x14</span><span class="p">,</span> <span class="mh">0x42</span><span class="p">,</span> <span class="mh">0x0e</span><span class="p">,</span> <span class="mh">0xb6</span><span class="p">,</span> <span class="mh">0xb2</span><span class="p">,</span> <span class="mh">0xb2</span><span class="p">,</span> <span class="mh">0xe6</span><span class="p">,</span> <span class="mh">0xeb</span><span class="p">,</span> <span class="mh">0xb4</span><span class="p">,</span> <span class="mh">0x83</span><span class="p">,</span> <span class="mh">0x8e</span><span class="p">,</span> <span class="mh">0xd7</span><span class="p">,</span> <span class="mh">0xe5</span><span class="p">,</span> <span class="mh">0xd4</span><span class="p">,</span> <span class="mh">0xd9</span><span class="p">,</span>
    <span class="mh">0xc3</span><span class="p">,</span> <span class="mh">0xf0</span><span class="p">,</span> <span class="mh">0x80</span><span class="p">,</span> <span class="mh">0x95</span><span class="p">,</span> <span class="mh">0xf1</span><span class="p">,</span> <span class="mh">0x82</span><span class="p">,</span> <span class="mh">0x82</span><span class="p">,</span> <span class="mh">0x9a</span><span class="p">,</span> <span class="mh">0xbd</span><span class="p">,</span> <span class="mh">0x95</span><span class="p">,</span> <span class="mh">0xa4</span><span class="p">,</span> <span class="mh">0x8d</span><span class="p">,</span> <span class="mh">0x9a</span><span class="p">,</span> <span class="mh">0x2b</span><span class="p">,</span> <span class="mh">0x30</span><span class="p">,</span> <span class="mh">0x69</span><span class="p">,</span>
    <span class="mh">0x4a</span><span class="p">,</span> <span class="mh">0x69</span><span class="p">,</span> <span class="mh">0x65</span><span class="p">,</span> <span class="mh">0x55</span><span class="p">,</span> <span class="mh">0x1c</span><span class="p">,</span> <span class="mh">0x7b</span><span class="p">,</span> <span class="mh">0x69</span><span class="p">,</span> <span class="mh">0x1c</span><span class="p">,</span> <span class="mh">0x6e</span><span class="p">,</span> <span class="mh">0x04</span><span class="p">,</span> <span class="mh">0x74</span><span class="p">,</span> <span class="mh">0x35</span><span class="p">,</span> <span class="mh">0x21</span><span class="p">,</span> <span class="mh">0x26</span><span class="p">,</span> <span class="mh">0x2f</span><span class="p">,</span> <span class="mh">0x60</span><span class="p">,</span>
    <span class="mh">0x03</span><span class="p">,</span> <span class="mh">0x4e</span><span class="p">,</span> <span class="mh">0x37</span><span class="p">,</span> <span class="mh">0x1e</span><span class="p">,</span> <span class="mh">0x33</span><span class="p">,</span> <span class="mh">0x54</span><span class="p">,</span> <span class="mh">0x39</span><span class="p">,</span> <span class="mh">0xe6</span><span class="p">,</span> <span class="mh">0xba</span><span class="p">,</span> <span class="mh">0xb4</span><span class="p">,</span> <span class="mh">0xa2</span><span class="p">,</span> <span class="mh">0xad</span><span class="p">,</span> <span class="mh">0xa4</span><span class="p">,</span> <span class="mh">0xc5</span><span class="p">,</span> <span class="mh">0x95</span><span class="p">,</span> <span class="mh">0xc8</span><span class="p">,</span>
    <span class="mh">0xc1</span><span class="p">,</span> <span class="mh">0xe4</span><span class="p">,</span> <span class="mh">0x8a</span><span class="p">,</span> <span class="mh">0xec</span><span class="p">,</span> <span class="mh">0xe7</span><span class="p">,</span> <span class="mh">0x92</span><span class="p">,</span> <span class="mh">0x8b</span><span class="p">,</span> <span class="mh">0xe8</span><span class="p">,</span> <span class="mh">0x81</span><span class="p">,</span> <span class="mh">0xf0</span><span class="p">,</span> <span class="mh">0xad</span><span class="p">,</span> <span class="mh">0x98</span><span class="p">,</span> <span class="mh">0xa4</span><span class="p">,</span> <span class="mh">0xd0</span><span class="p">,</span> <span class="mh">0xc0</span><span class="p">,</span> <span class="mh">0x8d</span><span class="p">,</span>
    <span class="mh">0xac</span><span class="p">,</span> <span class="mh">0x22</span><span class="p">,</span> <span class="mh">0x52</span><span class="p">,</span> <span class="mh">0x65</span><span class="p">,</span> <span class="mh">0x7e</span><span class="p">,</span> <span class="mh">0x27</span><span class="p">,</span> <span class="mh">0x2b</span><span class="p">,</span> <span class="mh">0x5a</span><span class="p">,</span> <span class="mh">0x12</span><span class="p">,</span> <span class="mh">0x61</span><span class="p">,</span> <span class="mh">0x0a</span><span class="p">,</span> <span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x7a</span><span class="p">,</span> <span class="mh">0x6b</span><span class="p">,</span> <span class="mh">0x1d</span><span class="p">,</span> <span class="mh">0x67</span><span class="p">,</span>
    <span class="mh">0x75</span><span class="p">,</span> <span class="mh">0x70</span><span class="p">,</span> <span class="mh">0x6c</span><span class="p">,</span> <span class="mh">0x1b</span><span class="p">,</span> <span class="mh">0x11</span><span class="p">,</span> <span class="mh">0x25</span><span class="p">,</span> <span class="mh">0x25</span><span class="p">,</span> <span class="mh">0x70</span><span class="p">,</span> <span class="mh">0x7f</span><span class="p">,</span> <span class="mh">0x7e</span><span class="p">,</span> <span class="mh">0x67</span><span class="p">,</span> <span class="mh">0x63</span><span class="p">,</span> <span class="mh">0x30</span><span class="p">,</span> <span class="mh">0x3c</span><span class="p">,</span> <span class="mh">0x6d</span><span class="p">,</span> <span class="mh">0x6a</span><span class="p">,</span>
    <span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x51</span><span class="p">,</span> <span class="mh">0x59</span><span class="p">,</span> <span class="mh">0x5f</span><span class="p">,</span> <span class="mh">0x56</span><span class="p">,</span> <span class="mh">0x13</span><span class="p">,</span> <span class="mh">0x10</span><span class="p">,</span> <span class="mh">0x43</span><span class="p">,</span> <span class="mh">0x19</span><span class="p">,</span> <span class="mh">0x18</span><span class="p">,</span> <span class="mh">0xe5</span><span class="p">,</span> <span class="mh">0xe0</span><span class="p">,</span> <span class="mh">0xbe</span><span class="p">,</span> <span class="mh">0xbf</span><span class="p">,</span> <span class="mh">0xbd</span><span class="p">,</span> <span class="mh">0xe9</span><span class="p">,</span>
    <span class="mh">0xf0</span><span class="p">,</span> <span class="mh">0xf1</span><span class="p">,</span> <span class="mh">0xf9</span><span class="p">,</span> <span class="mh">0xfa</span><span class="p">,</span> <span class="mh">0xab</span><span class="p">,</span> <span class="mh">0x8f</span><span class="p">,</span> <span class="mh">0xc1</span><span class="p">,</span> <span class="mh">0xdf</span><span class="p">,</span> <span class="mh">0xcf</span><span class="p">,</span> <span class="mh">0x8d</span><span class="p">,</span> <span class="mh">0xf8</span><span class="p">,</span> <span class="mh">0xe7</span><span class="p">,</span> <span class="mh">0xe2</span><span class="p">,</span> <span class="mh">0xe9</span><span class="p">,</span> <span class="mh">0x93</span><span class="p">,</span> <span class="mh">0x8e</span><span class="p">,</span>
    <span class="mh">0xec</span><span class="p">,</span> <span class="mh">0xf5</span><span class="p">,</span> <span class="mh">0xc8</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span>
    <span class="mh">0x37</span><span class="p">,</span> <span class="mh">0x7a</span><span class="p">,</span> <span class="mh">0x07</span><span class="p">,</span> <span class="mh">0x11</span><span class="p">,</span> <span class="mh">0x1f</span><span class="p">,</span> <span class="mh">0x1d</span><span class="p">,</span> <span class="mh">0x68</span><span class="p">,</span> <span class="mh">0x25</span><span class="p">,</span> <span class="mh">0x32</span><span class="p">,</span> <span class="mh">0x77</span><span class="p">,</span> <span class="mh">0x1e</span><span class="p">,</span> <span class="mh">0x62</span><span class="p">,</span> <span class="mh">0x23</span><span class="p">,</span> <span class="mh">0x5b</span><span class="p">,</span> <span class="mh">0x47</span><span class="p">,</span> <span class="mh">0x55</span><span class="p">,</span>
    <span class="mh">0x53</span><span class="p">,</span> <span class="mh">0x30</span><span class="p">,</span> <span class="mh">0x11</span><span class="p">,</span> <span class="mh">0x42</span><span class="p">,</span> <span class="mh">0xf6</span><span class="p">,</span> <span class="mh">0xf1</span><span class="p">,</span> <span class="mh">0xb1</span><span class="p">,</span> <span class="mh">0xe6</span><span class="p">,</span> <span class="mh">0xc3</span><span class="p">,</span> <span class="mh">0xcc</span><span class="p">,</span> <span class="mh">0xf8</span><span class="p">,</span> <span class="mh">0xc5</span><span class="p">,</span> <span class="mh">0xe4</span><span class="p">,</span> <span class="mh">0xcc</span><span class="p">,</span> <span class="mh">0xc0</span><span class="p">,</span> <span class="mh">0xd3</span><span class="p">,</span>
    <span class="mh">0x85</span><span class="p">,</span> <span class="mh">0xfd</span><span class="p">,</span> <span class="mh">0x9a</span><span class="p">,</span> <span class="mh">0xe3</span><span class="p">,</span> <span class="mh">0xe6</span><span class="p">,</span> <span class="mh">0x81</span><span class="p">,</span> <span class="mh">0xb5</span><span class="p">,</span> <span class="mh">0xbb</span><span class="p">,</span> <span class="mh">0xd7</span><span class="p">,</span> <span class="mh">0xcd</span><span class="p">,</span> <span class="mh">0x87</span><span class="p">,</span> <span class="mh">0xa3</span><span class="p">,</span> <span class="mh">0xd3</span><span class="p">,</span> <span class="mh">0x6b</span><span class="p">,</span> <span class="mh">0x36</span><span class="p">,</span> <span class="mh">0x6f</span><span class="p">,</span>
    <span class="mh">0x6f</span><span class="p">,</span> <span class="mh">0x66</span><span class="p">,</span> <span class="mh">0x55</span><span class="p">,</span> <span class="mh">0x30</span><span class="p">,</span> <span class="mh">0x16</span><span class="p">,</span> <span class="mh">0x45</span><span class="p">,</span> <span class="mh">0x5e</span><span class="p">,</span> <span class="mh">0x09</span><span class="p">,</span> <span class="mh">0x74</span><span class="p">,</span> <span class="mh">0x5c</span><span class="p">,</span> <span class="mh">0x3f</span><span class="p">,</span> <span class="mh">0x29</span><span class="p">,</span> <span class="mh">0x2b</span><span class="p">,</span> <span class="mh">0x66</span><span class="p">,</span> <span class="mh">0x3d</span><span class="p">,</span> <span class="mh">0x0d</span><span class="p">,</span>
    <span class="mh">0x02</span><span class="p">,</span> <span class="mh">0x30</span><span class="p">,</span> <span class="mh">0x28</span><span class="p">,</span> <span class="mh">0x35</span><span class="p">,</span> <span class="mh">0x15</span><span class="p">,</span> <span class="mh">0x09</span><span class="p">,</span> <span class="mh">0x15</span><span class="p">,</span> <span class="mh">0xdd</span><span class="p">,</span> <span class="mh">0xec</span><span class="p">,</span> <span class="mh">0xb8</span><span class="p">,</span> <span class="mh">0xe2</span><span class="p">,</span> <span class="mh">0xfb</span><span class="p">,</span> <span class="mh">0xd8</span><span class="p">,</span> <span class="mh">0xcb</span><span class="p">,</span> <span class="mh">0xd8</span><span class="p">,</span> <span class="mh">0xd1</span><span class="p">,</span>
    <span class="mh">0x8b</span><span class="p">,</span> <span class="mh">0xd5</span><span class="p">,</span> <span class="mh">0x82</span><span class="p">,</span> <span class="mh">0xd9</span><span class="p">,</span> <span class="mh">0x9a</span><span class="p">,</span> <span class="mh">0xf1</span><span class="p">,</span> <span class="mh">0x92</span><span class="p">,</span> <span class="mh">0xab</span><span class="p">,</span> <span class="mh">0xe8</span><span class="p">,</span> <span class="mh">0xa6</span><span class="p">,</span> <span class="mh">0xd6</span><span class="p">,</span> <span class="mh">0xd0</span><span class="p">,</span> <span class="mh">0x8c</span><span class="p">,</span> <span class="mh">0xaa</span><span class="p">,</span> <span class="mh">0xd2</span><span class="p">,</span> <span class="mh">0x94</span><span class="p">,</span>
    <span class="mh">0xcf</span><span class="p">,</span> <span class="mh">0x45</span><span class="p">,</span> <span class="mh">0x46</span><span class="p">,</span> <span class="mh">0x67</span><span class="p">,</span> <span class="mh">0x20</span><span class="p">,</span> <span class="mh">0x7d</span><span class="p">,</span> <span class="mh">0x44</span><span class="p">,</span> <span class="mh">0x14</span><span class="p">,</span> <span class="mh">0x6b</span><span class="p">,</span> <span class="mh">0x45</span><span class="p">,</span> <span class="mh">0x6d</span><span class="p">,</span> <span class="mh">0x54</span><span class="p">,</span> <span class="mh">0x03</span><span class="p">,</span> <span class="mh">0x17</span><span class="p">,</span> <span class="mh">0x60</span><span class="p">,</span> <span class="mh">0x62</span><span class="p">,</span>
    <span class="mh">0x55</span><span class="p">,</span> <span class="mh">0x5a</span><span class="p">,</span> <span class="mh">0x4a</span><span class="p">,</span> <span class="mh">0x66</span><span class="p">,</span> <span class="mh">0x61</span><span class="p">,</span> <span class="mh">0x11</span><span class="p">,</span> <span class="mh">0x57</span><span class="p">,</span> <span class="mh">0x68</span><span class="p">,</span> <span class="mh">0x75</span><span class="p">,</span> <span class="mh">0x05</span><span class="p">,</span> <span class="mh">0x62</span><span class="p">,</span> <span class="mh">0x36</span><span class="p">,</span> <span class="mh">0x7d</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="mh">0x10</span><span class="p">,</span> <span class="mh">0x4b</span><span class="p">,</span>
    <span class="mh">0x08</span><span class="p">,</span> <span class="mh">0x22</span><span class="p">,</span> <span class="mh">0x42</span><span class="p">,</span> <span class="mh">0x32</span><span class="p">,</span> <span class="mh">0xba</span><span class="p">,</span> <span class="mh">0xe2</span><span class="p">,</span> <span class="mh">0xb9</span><span class="p">,</span> <span class="mh">0xe2</span><span class="p">,</span> <span class="mh">0xd6</span><span class="p">,</span> <span class="mh">0xb9</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xc3</span><span class="p">,</span> <span class="mh">0xe9</span><span class="p">,</span> <span class="mh">0x8a</span><span class="p">,</span> <span class="mh">0x8f</span><span class="p">,</span> <span class="mh">0xc1</span><span class="p">,</span>
    <span class="mh">0x8f</span><span class="p">,</span> <span class="mh">0xe1</span><span class="p">,</span> <span class="mh">0xb8</span><span class="p">,</span> <span class="mh">0xa4</span><span class="p">,</span> <span class="mh">0x96</span><span class="p">,</span> <span class="mh">0xf1</span><span class="p">,</span> <span class="mh">0x8f</span><span class="p">,</span> <span class="mh">0x81</span><span class="p">,</span> <span class="mh">0xb1</span><span class="p">,</span> <span class="mh">0x8d</span><span class="p">,</span> <span class="mh">0x89</span><span class="p">,</span> <span class="mh">0xcc</span><span class="p">,</span> <span class="mh">0xd4</span><span class="p">,</span> <span class="mh">0x78</span><span class="p">,</span> <span class="mh">0x76</span><span class="p">,</span> <span class="mh">0x61</span><span class="p">,</span>
    <span class="mh">0x72</span><span class="p">,</span> <span class="mh">0x3e</span><span class="p">,</span> <span class="mh">0x37</span><span class="p">,</span> <span class="mh">0x23</span><span class="p">,</span> <span class="mh">0x56</span><span class="p">,</span> <span class="mh">0x73</span><span class="p">,</span> <span class="mh">0x71</span><span class="p">,</span> <span class="mh">0x79</span><span class="p">,</span> <span class="mh">0x63</span><span class="p">,</span> <span class="mh">0x7c</span><span class="p">,</span> <span class="mh">0x08</span><span class="p">,</span> <span class="mh">0x11</span><span class="p">,</span> <span class="mh">0x20</span><span class="p">,</span> <span class="mh">0x69</span><span class="p">,</span> <span class="mh">0x7a</span><span class="p">,</span> <span class="mh">0x14</span><span class="p">,</span>
    <span class="mh">0x68</span><span class="p">,</span> <span class="mh">0x05</span><span class="p">,</span> <span class="mh">0x21</span><span class="p">,</span> <span class="mh">0x1e</span><span class="p">,</span> <span class="mh">0x32</span><span class="p">,</span> <span class="mh">0x27</span><span class="p">,</span> <span class="mh">0x59</span><span class="p">,</span> <span class="mh">0xb7</span><span class="p">,</span> <span class="mh">0xcf</span><span class="p">,</span> <span class="mh">0xab</span><span class="p">,</span> <span class="mh">0xdd</span><span class="p">,</span> <span class="mh">0xd5</span><span class="p">,</span> <span class="mh">0xcc</span><span class="p">,</span> <span class="mh">0x97</span><span class="p">,</span> <span class="mh">0x93</span><span class="p">,</span> <span class="mh">0xf2</span><span class="p">,</span>
    <span class="mh">0xe7</span><span class="p">,</span> <span class="mh">0xc0</span><span class="p">,</span> <span class="mh">0xeb</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xe9</span><span class="p">,</span> <span class="mh">0xa3</span><span class="p">,</span> <span class="mh">0xbf</span><span class="p">,</span> <span class="mh">0xa1</span><span class="p">,</span> <span class="mh">0xab</span><span class="p">,</span> <span class="mh">0x8b</span><span class="p">,</span> <span class="mh">0xbb</span><span class="p">,</span> <span class="mh">0x9e</span><span class="p">,</span> <span class="mh">0x9e</span><span class="p">,</span> <span class="mh">0x8c</span><span class="p">,</span> <span class="mh">0xa0</span><span class="p">,</span> <span class="mh">0xc1</span><span class="p">,</span>
    <span class="mh">0x9b</span><span class="p">,</span> <span class="mh">0x5a</span><span class="p">,</span> <span class="mh">0x2f</span><span class="p">,</span> <span class="mh">0x2f</span><span class="p">,</span> <span class="mh">0x4e</span><span class="p">,</span> <span class="mh">0x4e</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span>
    <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span>
    <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span>
  <span class="p">],</span>
  <span class="na">exec</span><span class="p">:</span> <span class="kd">function</span><span class="p">()</span>
  <span class="p">{</span>
    <span class="c1">// virtual machine architecture</span>
    <span class="c1">// ++++++++++++++++++++++++++++</span>
    <span class="c1">//</span>
    <span class="c1">// segmented memory model with 16-byte segment size (notation seg:offset)</span>
    <span class="c1">//</span>
    <span class="c1">// 4 general-purpose registers (r0-r3)</span>
    <span class="c1">// 2 segment registers (cs, ds equiv. to r4, r5)</span>
    <span class="c1">// 1 flags register (fl)</span>
    <span class="c1">//</span>
    <span class="c1">// instruction encoding</span>
    <span class="c1">// ++++++++++++++++++++</span>
    <span class="c1">//</span>
    <span class="c1">//           byte 1               byte 2 (optional)</span>
    <span class="c1">// bits      [ 7 6 5 4 3 2 1 0 ]  [ 7 6 5 4 3 2 1 0 ]</span>
    <span class="c1">// opcode      - - -             </span>
    <span class="c1">// mod               -           </span>
    <span class="c1">// operand1            - - - -</span>
    <span class="c1">// operand2                         - - - - - - - -</span>
    <span class="c1">//</span>
    <span class="c1">// operand1 is always a register index</span>
    <span class="c1">// operand2 is optional, depending upon the instruction set specified below</span>
    <span class="c1">// the value of mod alters the meaning of any operand2</span>
    <span class="c1">//   0: operand2 = reg ix</span>
    <span class="c1">//   1: operand2 = fixed immediate value or target segment (depending on instruction)</span>
    <span class="c1">//</span>
    <span class="c1">// instruction set</span>
    <span class="c1">// +++++++++++++++</span>
    <span class="c1">// </span>
    <span class="c1">// Notes:</span>
    <span class="c1">//   * r1, r2 =&gt; operand 1 is register 1, operand 2 is register 2</span>
    <span class="c1">//   * movr r1, r2 =&gt; move contents of register r2 into register r1</span>
    <span class="c1">// </span>
    <span class="c1">// opcode | instruction | operands (mod 0) | operands (mod 1)</span>
    <span class="c1">// -------+-------------+------------------+-----------------</span>
    <span class="c1">// 0x00   | jmp         | r1               | r2:r1</span>
    <span class="c1">// 0x01   | movr        | r1, r2           | rx,   imm </span>
    <span class="c1">// 0x02   | movm        | r1, [ds:r2]      | [ds:r1], r2</span>
    <span class="c1">// 0x03   | add         | r1, r2           | r1,   imm</span>
    <span class="c1">// 0x04   | xor         | r1, r2           | r1,   imm </span>
    <span class="c1">// 0x05   | cmp         | r1, r2           | r1,   imm </span>
    <span class="c1">// 0x06   | jmpe        | r1               | r2:r1</span>
    <span class="c1">// 0x07   | hlt         | N/A              | N/A</span>
    <span class="c1">//</span>
    <span class="c1">// flags</span>
    <span class="c1">// +++++</span>
    <span class="c1">// </span>
    <span class="c1">// cmp r1, r2 instruction results in:</span>
    <span class="c1">//   r1 == r2 =&gt; fl = 0</span>
    <span class="c1">//   r1 &lt; r2  =&gt; fl = 0xff</span>
    <span class="c1">//   r1 &gt; r2  =&gt; fl = 1</span>
    <span class="c1">// </span>
    <span class="c1">// jmpe r1</span>
    <span class="c1">//   =&gt; if (fl == 0) jmp r1</span>
    <span class="c1">//      else nop</span>
    <span class="k">throw</span> <span class="s2">"VM.exec not yet implemented"</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">};</span>

<span class="c1">//--------------------------------------------------------------------------------------------------</span>

<span class="k">try</span>
<span class="p">{</span>
  <span class="nx">VM</span><span class="p">.</span><span class="nx">exec</span><span class="p">();</span>
<span class="p">}</span>
<span class="k">catch</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span>
<span class="p">{</span>
  <span class="nx">alert</span><span class="p">(</span><span class="s1">'</span><span class="err">\</span><span class="s1">nError: '</span> <span class="o">+</span> <span class="nx">e</span> <span class="o">+</span> <span class="s1">'</span><span class="err">\</span><span class="s1">n'</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">//--------------------------------------------------------------------------------------------------</span></pre></td></tr></tbody></table></code></pre></figure>

<p>Okay, the challenge consist in implementing a virtual CPU that will be able to execute the bytecode and decrypt the parts that interest us.</p>

<h1 id="the-vm">The VM</h1>

<p>Hell, I am not a Web guy so I do not master JavaScript … who said I had to use JavaScript?
Thus I coded my VM in C, it is included in the archive at the end of the post (600-700 lines of code is too much for a post :)).</p>

<p>I implemented the VM, a disassembler and some debug stuffs.</p>

<h1 id="the-disassembled-byte-code">The disassembled byte code</h1>

<p>Before executing any code:</p>

<figure class="highlight"><pre><code class="language-text" data-lang="text"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
</pre></td><td class="code"><pre>== DISASM (before)
0x0000: movr r1, 4
0x0002: movr r3, 170
0x0004: movm r0, [ds:r2]
0x0006: xor r0, r3
0x0008: movm [ds:r2], r0
0x000a: add r2, 1
0x000c: add r3, 1
0x000e: cmp r2, 80
0x0010: movr r0, 20
0x0012: jmpe r0
0x0013: jmp r1
0x0014: xor r0, r0
0x0016: jmp 16:r0
0x0018: jmp r0
0x0019: jmp r0
0x001a: jmp r0
[...]
0x00fa: jmp r0
0x00fb: jmp r0
0x00fc: jmp r0
0x00fd: jmp r0
0x00fe: jmp r0
0x00ff: jmp r0
0x0100: xor r0, 171
0x0102: jmpe 161:r1
0x0104: invalid
0x0106: xor r3, r3
0x0108: hlt
0x0109: cmp r1, 52
0x010b: invalid
0x010d: invalid
0x010f: cmp r0, 201
0x0111: cmp r0, 14
0x0113: cmp ds, 125
0x0115: invalid
0x0116: jmpe r0
0x0117: hlt
0x0118: jmpe 3:r1
0x011a: invalid
0x011b: movr r2, 198
0x011d: invalid
0x011e: jmpe r0
0x011f: jmpe r1
0x0120: jmpe r2
0x0121: jmpe r3
0x0122: invalid
0x0123: invalid
0x0124: invalid
0x0125: invalid</pre></td></tr></tbody></table></code></pre></figure>

<p>As you can see you have a first loop from address 0x0 to 0x16.
The second loop is completely junk as we have invalid instructions.</p>

<p>The first loop will loop till r2 is 80.
Basically, it will decode 80 bytes of the “data section” with keys ranging from 170 to 250.
The data section is located at offset 256 and the code section at offset 0.
Once we decrypted 80 bytes, we change our code section so it points at offset 256.
We basically decoded a second payload.</p>

<p>The code at the end:</p>

<figure class="highlight"><pre><code class="language-text" data-lang="text"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
</pre></td><td class="code"><pre>== DISASM (after)
0x0000: movr r1, 4
0x0002: movr r3, 170
0x0004: movm r0, [ds:r2]
0x0006: xor r0, r3
0x0008: movm [ds:r2], r0
0x000a: add r2, 1
0x000c: add r3, 1
0x000e: cmp r2, 80
0x0010: movr r0, 20
0x0012: jmpe r0
0x0013: jmp r1
0x0014: xor r0, r0
0x0016: jmp 16:r0
0x0018: jmp r0
0x0019: jmp r0
0x001a: jmp r0
[...]
0x00fa: jmp r0
0x00fb: jmp r0
0x00fc: jmp r0
0x00fd: jmp r0
0x00fe: jmp r0
0x00ff: jmp r0
0x0100: movr r2, 0
0x0102: add ds, 12
0x0104: movr r1, 8
0x0106: movr r3, 50
0x0108: movm r0, [ds:r2]
0x010a: xor r0, r3
0x010c: movm [ds:r2], r0
0x010e: add r2, 1
0x0110: add r3, 3
0x0112: cmp r2, 0
0x0114: jmpe r3
0x0115: cmp r0, 0
0x0117: movr r0, 27
0x0119: jmpe r0
0x011a: jmp r1
0x011b: hlt
0x011c: jmp r0
0x011d: jmp r0
[...]
0x0130: jmp r0
0x0131: jmp r0
0x0132: add ds, 16
0x0134: jmp r1
0x0135: jmp r0
0x0136: jmp r0
0x0137: jmp r0
0x0138: jmp r0
0x0139: jmp r0
0x013a: jmp r0
0x013b: jmp r0
0x013c: jmp r0
0x013d: jmp r0
0x013e: jmp r0
0x013f: jmp r0
0x0140: invalid
0x0141: jmp r0
0x0142: jmp r0
0x0143: jmp r0
0x0144: jmp r0
0x0145: jmp r0
0x0146: jmp r0
0x0147: jmp r0
0x0148: jmp r0</pre></td></tr></tbody></table></code></pre></figure>

<p>Now at offset 0x100, we can see our decoded payload.
It is a second decoding loop ;).
It changes ds so it points to the encoded payload.
It stop decoding as soon as it reaches the end of the decoded string: ‘\0’.</p>

<p>The thing is … we still have 256 bytes that we have no idea of what it is as we can seen from the dumps.</p>

<figure class="highlight"><pre><code class="language-text" data-lang="text"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre></td><td class="code"><pre> 28 : 0x1c0 : 47 45 54 20 2f 64 61 37 35 33 37 30 66 65 31 35 | GET /da75370fe15
 29 : 0x1d0 : 63 34 31 34 38 62 64 34 63 65 65 63 38 36 31 66 | c4148bd4ceec861f
 30 : 0x1e0 : 62 64 61 61 35 2e 65 78 65 20 48 54 54 50 2f 31 | bdaa5.exe HTTP/1
 31 : 0x1f0 : 2e 30 00 00 00 00 00 00 00 00 00 00 00 00 00 00 | .0..............
 32 : 0x200 : 37 7a 07 11 1f 1d 68 25 32 77 1e 62 23 5b 47 55 | 7z....h%2w.b#[GU
 33 : 0x210 : 53 30 11 42 f6 f1 b1 e6 c3 cc f8 c5 e4 cc c0 d3 | S0.B............
 34 : 0x220 : 85 fd 9a e3 e6 81 b5 bb d7 cd 87 a3 d3 6b 36 6f | .............k6o
 35 : 0x230 : 6f 66 55 30 16 45 5e 09 74 5c 3f 29 2b 66 3d 0d | ofU0.E^.t\?)+f=.
 36 : 0x240 : 02 30 28 35 15 09 15 dd ec b8 e2 fb d8 cb d8 d1 | .0(5............
 37 : 0x250 : 8b d5 82 d9 9a f1 92 ab e8 a6 d6 d0 8c aa d2 94 | ................
 38 : 0x260 : cf 45 46 67 20 7d 44 14 6b 45 6d 54 03 17 60 62 | .EFg }D.kEmT..`b
 39 : 0x270 : 55 5a 4a 66 61 11 57 68 75 05 62 36 7d 02 10 4b | UZJfa.Whu.b6}..K
 40 : 0x280 : 08 22 42 32 ba e2 b9 e2 d6 b9 ff c3 e9 8a 8f c1 | ."B2............
 41 : 0x290 : 8f e1 b8 a4 96 f1 8f 81 b1 8d 89 cc d4 78 76 61 | .............xva
 42 : 0x2a0 : 72 3e 37 23 56 73 71 79 63 7c 08 11 20 69 7a 14 | r&gt;7#Vsqyc|.. iz.
 43 : 0x2b0 : 68 05 21 1e 32 27 59 b7 cf ab dd d5 cc 97 93 f2 | h.!.2'Y.........
 44 : 0x2c0 : e7 c0 eb ff e9 a3 bf a1 ab 8b bb 9e 9e 8c a0 c1 | ................
 45 : 0x2d0 : 9b 5a 2f 2f 4e 4e 00 00 00 00 00 00 00 00 00 00 | .Z//NN..........
 46 : 0x2e0 : 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 | ................
 47 : 0x2f0 : 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 | ................</pre></td></tr></tbody></table></code></pre></figure>

<p>So you can see our decoded string is GET …</p>

<figure class="highlight"><pre><code class="language-text" data-lang="text"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="code"><pre>[+] Initializing VM CPU
[+] Executing bytecode
[+] Finished executing bytecode
[+] Answer: 'GET /da75370fe15c4148bd4ceec861fbdaa5.exe HTTP/1.0'</pre></td></tr></tbody></table></code></pre></figure>

<p>But after the GET, we have 256+ bytes that has not been modified in any way …
Someone found what it is? (and no it does not seem to be a valid 7zip file :().</p>

<h1 id="conclusion">Conclusion</h1>

<p>This level was more interesting and more programming related.
Implementing a VM was something I never did before … but was fun :).
Any person who did some “Computer Science” should thus be able to solve this level without much difficulties.</p>

<p>To be continued on the next level …</p>

<p>m_101</p>

<h1 id="resources">Resources</h1>

<ul>
  <li>My solutions: <a href="http://www.mediafire.com/?6hej4szvrqyll6j">here</a> or <a href="/binholic/assets/others/gchq.zip">here</a></li>
</ul>

  </div>

  <div class="post-navigation">
    
    <a class="post-prev" href="/binholic/2011/12/01/gchq-challenge-part-1.html">Previous : GCHQ Challenge Part 1 - http://www.canyoucrackit.co.uk/</a>
    

    
    <a class="post-next" href="/binholic/2011/12/03/gchq-challenge-part-3.html">Next : GCHQ Challenge Part 3 : www.canyoucrackit.co.uk</a>
    
  </div>

  
    <div id="disqus_thread"></div>
    <script>
        var disqus_config = function () {
            this.page.url = "http://binholic.com/2011/12/03/gchq-challenge-part-2.html";
            this.page.identifier = "/2011/12/03/gchq-challenge-part-2";
        };

        (function() { // DON'T EDIT BELOW THIS LINE
            var d = document, s = d.createElement('script');

            s.src = '//binholic.disqus.com/embed.js';

            s.setAttribute('data-timestamp', +new Date());
            (d.head || d.body).appendChild(s);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
  

</article>

      </div>
    </div>

    <footer class="site-footer">

  <div class="wrapper">

      <div class="site-footer">
        <ul class="social-media-list">
          
          <li>
            <a href="https://github.com/m101"><span class="icon icon--github"><svg viewBox="0 0 16 16"><path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/></svg>
</span></a>

          </li>
          

          
          <li>
            <a href="https://twitter.com/w_levin"><span class="icon icon--twitter"><svg viewBox="0 0 16 16"><path fill="#828282" d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27 c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767 c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206 C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271 c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469 c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"/></svg>
</span></a>

          </li>
          

          
          <li>
            <a href="mailto:m101.sec@gmail.com"><span class="icon icon--email"><?xml version="1.0" encoding="UTF-8"?>
<!-- Generator: Adobe Illustrator 16.0.0, SVG Export Plug-In . SVG Version: 6.00 Build 0)  -->
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="240.665px" height="250px" viewBox="43.833 205.167 240.665 250" enable-background="new 43.833 205.167 240.665 250" xml:space="preserve">
<g>
	<path fill="#323232" d="M221.459,396.62c-8.84,0-15.904-2.21-21.191-6.63c-5.289-4.42-8.449-10.441-9.488-18.07   c-4.855,5.895-10.66,10.965-17.42,15.21c-6.762,4.249-14.561,6.37-23.4,6.37c-6.59,0-12.83-1.256-18.72-3.77   c-5.895-2.512-11.095-6.15-15.6-10.92c-4.509-4.766-8.105-10.571-10.79-17.42c-2.689-6.846-4.03-14.69-4.03-23.531   c0-9.879,1.56-19.064,4.68-27.56c3.12-8.49,7.365-15.86,12.74-22.1c5.371-6.24,11.7-11.136,18.98-14.69   c7.28-3.551,15.08-5.33,23.4-5.33c9.01,0,16.68,1.82,23.01,5.461c6.324,3.639,11.311,8.234,14.949,13.779l2.34-17.42h20.541   l-10.66,85.02c-0.52,3.99-0.781,7.021-0.781,9.101c0,5.029,1.041,8.929,3.121,11.7c2.08,2.774,5.545,4.16,10.4,4.16   c4.504,0,8.84-1.646,13-4.94c4.16-3.29,7.799-7.931,10.92-13.91c3.119-5.979,5.589-13.085,7.41-21.319   c1.82-8.23,2.729-17.291,2.729-27.17c0-11.961-2.123-23.051-6.369-33.281c-4.25-10.225-10.228-19.064-17.939-26.52   c-7.715-7.451-16.859-13.26-27.43-17.42c-10.576-4.16-22.189-6.24-34.842-6.24c-16.119,0-30.464,3.165-43.029,9.49   c-12.57,6.33-23.14,14.605-31.72,24.83c-8.58,10.229-15.08,21.799-19.5,34.71c-4.42,12.915-6.63,26.045-6.63,39.39   c0,15.08,2.34,28.516,7.02,40.301c4.68,11.789,11.18,21.795,19.5,30.029c8.32,8.23,18.11,14.471,29.38,18.721   c11.265,4.244,23.485,6.369,36.661,6.369c13.17,0,24.914-1.561,35.229-4.68c10.311-3.121,20.15-6.936,29.512-11.439l7.539,19.76   c-9.016,4.85-19.891,8.924-32.631,12.219c-12.738,3.291-26.479,4.941-41.209,4.941c-16.64,0-31.98-2.516-46.02-7.541   c-14.04-5.029-26.175-12.439-36.4-22.23c-10.229-9.795-18.2-21.84-23.92-36.139c-5.72-14.301-8.58-30.811-8.58-49.53   c0-17.331,2.99-33.841,8.97-49.53c5.98-15.686,14.471-29.51,25.48-41.47c11.005-11.96,24.266-21.45,39.78-28.47   c15.51-7.02,32.889-10.53,52.129-10.53c16.291,0,31.156,2.645,44.59,7.93c13.432,5.29,24.916,12.524,34.451,21.71   c9.529,9.189,16.898,20.064,22.1,32.63c5.199,12.568,7.799,26.129,7.799,40.689c0,12.48-1.518,23.965-4.549,34.45   c-3.035,10.489-7.195,19.5-12.48,27.04c-5.289,7.54-11.615,13.391-18.98,17.55C238.139,394.54,230.124,396.62,221.459,396.62z    M156.979,374.26c6.76,0,13-1.86,18.721-5.59c5.719-3.725,10.311-7.756,13.779-12.09l6.24-51.48   c-3.469-5.545-7.975-10.051-13.52-13.52c-5.551-3.465-11.875-5.2-18.98-5.2c-5.201,0-10.23,1.17-15.08,3.511   c-4.855,2.34-9.145,5.635-12.87,9.879c-3.729,4.25-6.675,9.32-8.84,15.211c-2.169,5.895-3.25,12.395-3.25,19.5   c0,13.174,3.291,23.1,9.88,29.77C139.645,370.925,147.62,374.26,156.979,374.26z"/>
</g>
</svg></span></a>

          </li>
          

          
          <li>
            <a href="http://127.0.0.1:8888/USK@ABR8mm2t1L1G8cBG70cDy4PHFO6LPV~LrA-RIZxgOGI,pnGWUxb7k8~5-ywwqnBakTXx5ZFw6QzzZj7H~45NgE8,AQACAAE/binholic/-1/"><span class="icon icon--freenet"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!-- Created with Inkscape (http://www.inkscape.org/) -->
<svg
   xmlns:svg="http://www.w3.org/2000/svg"
   xmlns="http://www.w3.org/2000/svg"
   version="1.0"
   width="79.12"
   height="52.64">
  <defs/>
  <g
     transform="translate(-47.495719,-111.30691)">
    <path
       d="M 80.03,122.66 C 94.49,107.06 104.32,113.99 87.53,124.89 C 82.19,128.36 83.58,129.37 87.17,128.82 C 92.24,128.05 95.01,129.02 96.24,129.98 C 99.18,132.28 100.65,130.57 101.64,128.82 C 103.61,125.35 110.25,129.12 105.39,132.75 C 101.59,135.58 102.12,138.77 105.57,140.61 C 111.96,144.01 126.30,150.75 124.14,157.93 C 123.26,160.86 121.67,163.62 118.07,159.89 C 111.32,152.92 106.83,146.97 91.28,144.54 C 81.24,142.96 71.15,140.33 61.46,145.25 C 56.90,147.67 51.16,149.23 49.94,146.37 C 48.35,142.64 56.47,139.57 64.32,138.82 C 69.42,138.33 73.99,134.99 67.00,133.29 C 58.39,130.64 68.28,123.09 74.50,124.89 C 78.55,126.07 78.95,123.83 80.03,122.66 z"
       style="fill:#ffffff;stroke:#356ace;stroke-width:1.5;" />
  </g>
</svg>
</span></a>

          </li>
          
        </ul>
      </div>

    </div>

  </div>

</footer>


  </body>

</html>
